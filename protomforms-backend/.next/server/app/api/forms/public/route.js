"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/forms/public/route";
exports.ids = ["app/api/forms/public/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fforms%2Fpublic%2Froute&page=%2Fapi%2Fforms%2Fpublic%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fforms%2Fpublic%2Froute.ts&appDir=C%3A%5CUsers%5CGiuseppe%20Mursia%5CDocuments%5CGitHub%5CAGO_Explorer%5CProtomForms%5Cprotomforms-backend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CGiuseppe%20Mursia%5CDocuments%5CGitHub%5CAGO_Explorer%5CProtomForms%5Cprotomforms-backend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fforms%2Fpublic%2Froute&page=%2Fapi%2Fforms%2Fpublic%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fforms%2Fpublic%2Froute.ts&appDir=C%3A%5CUsers%5CGiuseppe%20Mursia%5CDocuments%5CGitHub%5CAGO_Explorer%5CProtomForms%5Cprotomforms-backend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CGiuseppe%20Mursia%5CDocuments%5CGitHub%5CAGO_Explorer%5CProtomForms%5Cprotomforms-backend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Giuseppe_Mursia_Documents_GitHub_AGO_Explorer_ProtomForms_protomforms_backend_src_app_api_forms_public_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/forms/public/route.ts */ \"(rsc)/./src/app/api/forms/public/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/forms/public/route\",\n        pathname: \"/api/forms/public\",\n        filename: \"route\",\n        bundlePath: \"app/api/forms/public/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Giuseppe Mursia\\\\Documents\\\\GitHub\\\\AGO_Explorer\\\\ProtomForms\\\\protomforms-backend\\\\src\\\\app\\\\api\\\\forms\\\\public\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Giuseppe_Mursia_Documents_GitHub_AGO_Explorer_ProtomForms_protomforms_backend_src_app_api_forms_public_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/forms/public/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZmb3JtcyUyRnB1YmxpYyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGZm9ybXMlMkZwdWJsaWMlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZmb3JtcyUyRnB1YmxpYyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNHaXVzZXBwZSUyME11cnNpYSU1Q0RvY3VtZW50cyU1Q0dpdEh1YiU1Q0FHT19FeHBsb3JlciU1Q1Byb3RvbUZvcm1zJTVDcHJvdG9tZm9ybXMtYmFja2VuZCU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDR2l1c2VwcGUlMjBNdXJzaWElNUNEb2N1bWVudHMlNUNHaXRIdWIlNUNBR09fRXhwbG9yZXIlNUNQcm90b21Gb3JtcyU1Q3Byb3RvbWZvcm1zLWJhY2tlbmQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9c3RhbmRhbG9uZSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNxRjtBQUNsSztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3Byb3RvbWZvcm1zLWJhY2tlbmQvP2NmMDAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcR2l1c2VwcGUgTXVyc2lhXFxcXERvY3VtZW50c1xcXFxHaXRIdWJcXFxcQUdPX0V4cGxvcmVyXFxcXFByb3RvbUZvcm1zXFxcXHByb3RvbWZvcm1zLWJhY2tlbmRcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcZm9ybXNcXFxccHVibGljXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcInN0YW5kYWxvbmVcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZm9ybXMvcHVibGljL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZm9ybXMvcHVibGljXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9mb3Jtcy9wdWJsaWMvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxHaXVzZXBwZSBNdXJzaWFcXFxcRG9jdW1lbnRzXFxcXEdpdEh1YlxcXFxBR09fRXhwbG9yZXJcXFxcUHJvdG9tRm9ybXNcXFxccHJvdG9tZm9ybXMtYmFja2VuZFxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxmb3Jtc1xcXFxwdWJsaWNcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2Zvcm1zL3B1YmxpYy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fforms%2Fpublic%2Froute&page=%2Fapi%2Fforms%2Fpublic%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fforms%2Fpublic%2Froute.ts&appDir=C%3A%5CUsers%5CGiuseppe%20Mursia%5CDocuments%5CGitHub%5CAGO_Explorer%5CProtomForms%5Cprotomforms-backend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CGiuseppe%20Mursia%5CDocuments%5CGitHub%5CAGO_Explorer%5CProtomForms%5Cprotomforms-backend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/forms/public/route.ts":
/*!*******************************************!*\
  !*** ./src/app/api/forms/public/route.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n\n\n\n\n// Handle OPTIONS preflight requests for CORS\nasync function OPTIONS(request) {\n    const origin = request.headers.get(\"origin\");\n    const allowedOrigins = [\n        process.env.FRONTEND_URL || \"http://localhost:3000\",\n        \"http://localhost:3000\",\n        \"http://localhost:3001\"\n    ];\n    const responseOrigin = origin && allowedOrigins.includes(origin) ? origin : allowedOrigins[0];\n    return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(null, {\n        status: 200,\n        headers: {\n            \"Access-Control-Allow-Origin\": responseOrigin,\n            \"Access-Control-Allow-Methods\": \"GET, OPTIONS\",\n            \"Access-Control-Allow-Headers\": \"Content-Type, Cookie, Authorization\",\n            \"Access-Control-Allow-Credentials\": \"true\",\n            \"Access-Control-Max-Age\": \"86400\"\n        }\n    });\n}\n// GET /api/forms/public - Get all public forms available for users\nasync function GET(request) {\n    try {\n        console.log(\"\\uD83D\\uDCE5 GET /api/forms/public - Request received\");\n        // Non bloccare se getServerSession va in timeout - questo endpoint deve funzionare sempre\n        let session = null;\n        let userId = null;\n        try {\n            session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_1__.getServerSession)(_lib_auth__WEBPACK_IMPORTED_MODULE_2__.authOptions);\n            userId = session?.user?.id;\n            console.log(\"âœ… Session retrieved:\", userId ? `User: ${userId}` : \"No session\");\n        } catch (sessionError) {\n            console.warn(\"âš ï¸ Session check failed (non-critical):\", sessionError);\n        // Continua senza sessione - l'endpoint deve funzionare anche senza autenticazione\n        }\n        console.log(\"\\uD83D\\uDD0D Fetching public forms from database...\");\n        // Get all public forms (isPublic: true)\n        // Se hanno status PUBLISHED li mostriamo, altrimenti mostriamo comunque quelli pubblici\n        // Questo permette retrocompatibilitÃ  con form che non hanno ancora lo status impostato\n        const forms = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.form.findMany({\n            where: {\n                isPublic: true\n            },\n            include: {\n                owner: {\n                    select: {\n                        id: true,\n                        name: true,\n                        email: true\n                    }\n                },\n                questions: {\n                    select: {\n                        id: true,\n                        text: true,\n                        type: true,\n                        required: true,\n                        order: true\n                    },\n                    orderBy: {\n                        order: \"asc\"\n                    }\n                },\n                responses: {\n                    select: {\n                        id: true,\n                        userId: true,\n                        createdAt: true\n                    }\n                }\n            },\n            orderBy: {\n                updatedAt: \"desc\"\n            }\n        });\n        console.log(`ðŸ“‹ Found ${forms.length} public forms`);\n        // Check if user has already responded to any forms (only if authenticated)\n        let availableForms = forms;\n        if (userId) {\n            console.log(`ðŸ” Filtering forms for user ${userId}...`);\n            const userResponses = await _lib_prisma__WEBPACK_IMPORTED_MODULE_3__.prisma.response.findMany({\n                where: {\n                    userId: userId\n                },\n                select: {\n                    formId: true\n                }\n            });\n            const answeredFormIds = new Set(userResponses.map((r)=>r.formId));\n            // Filter out forms the user has already answered\n            availableForms = forms.filter((form)=>!answeredFormIds.has(form.id));\n            console.log(`âœ… ${availableForms.length} forms available for user (${forms.length - availableForms.length} already answered)`);\n        } else {\n            console.log(\"â„¹ï¸ No user session - showing all public forms\");\n        }\n        // Formatta i dati per il frontend in modo compatibile\n        const formattedForms = availableForms.map((form)=>({\n                id: form.id,\n                title: form.title,\n                description: form.description || \"\",\n                type: form.type,\n                isPublic: form.isPublic,\n                isAnonymous: form.isAnonymous,\n                allowEdit: form.allowEdit,\n                showResults: form.showResults,\n                opensAt: form.opensAt?.toISOString(),\n                closesAt: form.closesAt?.toISOString(),\n                createdAt: form.createdAt.toISOString(),\n                updatedAt: form.updatedAt.toISOString(),\n                owner: {\n                    id: form.owner.id,\n                    name: form.owner.name || \"Utente Sconosciuto\",\n                    email: form.owner.email\n                },\n                questions: form.questions,\n                responses: form.responses\n            }));\n        console.log(`âœ… Returning ${formattedForms.length} formatted forms`);\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(formattedForms);\n        // Aggiungi CORS headers espliciti\n        const origin = request.headers.get(\"origin\");\n        const allowedOrigins = [\n            process.env.FRONTEND_URL || \"http://localhost:3000\",\n            \"http://localhost:3000\",\n            \"http://localhost:3001\"\n        ];\n        const responseOrigin = origin && allowedOrigins.includes(origin) ? origin : allowedOrigins[0];\n        response.headers.set(\"Access-Control-Allow-Origin\", responseOrigin);\n        response.headers.set(\"Access-Control-Allow-Credentials\", \"true\");\n        response.headers.set(\"Access-Control-Allow-Methods\", \"GET, OPTIONS\");\n        response.headers.set(\"Access-Control-Allow-Headers\", \"Content-Type, Cookie\");\n        return response;\n    } catch (error) {\n        console.error(\"âŒ Error fetching public forms:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9mb3Jtcy9wdWJsaWMvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUF3RDtBQUNYO0FBQ0o7QUFDSDtBQUV0Qyw2Q0FBNkM7QUFDdEMsZUFBZUksUUFBUUMsT0FBb0I7SUFDaEQsTUFBTUMsU0FBU0QsUUFBUUUsT0FBTyxDQUFDQyxHQUFHLENBQUM7SUFDbkMsTUFBTUMsaUJBQWlCO1FBQ3JCQyxRQUFRQyxHQUFHLENBQUNDLFlBQVksSUFBSTtRQUM1QjtRQUNBO0tBQ0Q7SUFDRCxNQUFNQyxpQkFBaUJQLFVBQVVHLGVBQWVLLFFBQVEsQ0FBQ1IsVUFBVUEsU0FBU0csY0FBYyxDQUFDLEVBQUU7SUFFN0YsT0FBTyxJQUFJVCxxREFBWUEsQ0FBQyxNQUFNO1FBQzVCZSxRQUFRO1FBQ1JSLFNBQVM7WUFDUCwrQkFBK0JNO1lBQy9CLGdDQUFnQztZQUNoQyxnQ0FBZ0M7WUFDaEMsb0NBQW9DO1lBQ3BDLDBCQUEwQjtRQUM1QjtJQUNGO0FBQ0Y7QUFFQSxtRUFBbUU7QUFDNUQsZUFBZUcsSUFBSVgsT0FBb0I7SUFDNUMsSUFBSTtRQUNGWSxRQUFRQyxHQUFHLENBQUM7UUFFWiwwRkFBMEY7UUFDMUYsSUFBSUMsVUFBVTtRQUNkLElBQUlDLFNBQVM7UUFFYixJQUFJO1lBQ0ZELFVBQVUsTUFBTWxCLDJEQUFnQkEsQ0FBQ0Msa0RBQVdBO1lBQzVDa0IsU0FBU0QsU0FBU0UsTUFBTUM7WUFDeEJMLFFBQVFDLEdBQUcsQ0FBQyx3QkFBd0JFLFNBQVMsQ0FBQyxNQUFNLEVBQUVBLE9BQU8sQ0FBQyxHQUFHO1FBQ25FLEVBQUUsT0FBT0csY0FBYztZQUNyQk4sUUFBUU8sSUFBSSxDQUFDLDJDQUEyQ0Q7UUFDeEQsa0ZBQWtGO1FBQ3BGO1FBRUFOLFFBQVFDLEdBQUcsQ0FBQztRQUVaLHdDQUF3QztRQUN4Qyx3RkFBd0Y7UUFDeEYsdUZBQXVGO1FBQ3ZGLE1BQU1PLFFBQVEsTUFBTXRCLCtDQUFNQSxDQUFDdUIsSUFBSSxDQUFDQyxRQUFRLENBQUM7WUFDdkNDLE9BQU87Z0JBQ0xDLFVBQVU7WUFHWjtZQUNBQyxTQUFTO2dCQUNQQyxPQUFPO29CQUNMQyxRQUFRO3dCQUNOVixJQUFJO3dCQUNKVyxNQUFNO3dCQUNOQyxPQUFPO29CQUNUO2dCQUNGO2dCQUNBQyxXQUFXO29CQUNUSCxRQUFRO3dCQUNOVixJQUFJO3dCQUNKYyxNQUFNO3dCQUNOQyxNQUFNO3dCQUNOQyxVQUFVO3dCQUNWQyxPQUFPO29CQUNUO29CQUNBQyxTQUFTO3dCQUNQRCxPQUFPO29CQUNUO2dCQUNGO2dCQUNBRSxXQUFXO29CQUNUVCxRQUFRO3dCQUNOVixJQUFJO3dCQUNKRixRQUFRO3dCQUNSc0IsV0FBVztvQkFDYjtnQkFDRjtZQUNGO1lBQ0FGLFNBQVM7Z0JBQ1BHLFdBQVc7WUFDYjtRQUNGO1FBRUExQixRQUFRQyxHQUFHLENBQUMsQ0FBQyxTQUFTLEVBQUVPLE1BQU1tQixNQUFNLENBQUMsYUFBYSxDQUFDO1FBRW5ELDJFQUEyRTtRQUMzRSxJQUFJQyxpQkFBaUJwQjtRQUVyQixJQUFJTCxRQUFRO1lBQ1ZILFFBQVFDLEdBQUcsQ0FBQyxDQUFDLDRCQUE0QixFQUFFRSxPQUFPLEdBQUcsQ0FBQztZQUN0RCxNQUFNMEIsZ0JBQWdCLE1BQU0zQywrQ0FBTUEsQ0FBQzRDLFFBQVEsQ0FBQ3BCLFFBQVEsQ0FBQztnQkFDbkRDLE9BQU87b0JBQ0xSLFFBQVFBO2dCQUNWO2dCQUNBWSxRQUFRO29CQUNOZ0IsUUFBUTtnQkFDVjtZQUNGO1lBRUEsTUFBTUMsa0JBQWtCLElBQUlDLElBQUlKLGNBQWNLLEdBQUcsQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUosTUFBTTtZQUUvRCxpREFBaUQ7WUFDakRILGlCQUFpQnBCLE1BQU00QixNQUFNLENBQUMzQixDQUFBQSxPQUFRLENBQUN1QixnQkFBZ0JLLEdBQUcsQ0FBQzVCLEtBQUtKLEVBQUU7WUFDbEVMLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsRUFBRTJCLGVBQWVELE1BQU0sQ0FBQywyQkFBMkIsRUFBRW5CLE1BQU1tQixNQUFNLEdBQUdDLGVBQWVELE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQztRQUM5SCxPQUFPO1lBQ0wzQixRQUFRQyxHQUFHLENBQUM7UUFDZDtRQUVBLHNEQUFzRDtRQUN0RCxNQUFNcUMsaUJBQWlCVixlQUFlTSxHQUFHLENBQUN6QixDQUFBQSxPQUFTO2dCQUNqREosSUFBSUksS0FBS0osRUFBRTtnQkFDWGtDLE9BQU85QixLQUFLOEIsS0FBSztnQkFDakJDLGFBQWEvQixLQUFLK0IsV0FBVyxJQUFJO2dCQUNqQ3BCLE1BQU1YLEtBQUtXLElBQUk7Z0JBQ2ZSLFVBQVVILEtBQUtHLFFBQVE7Z0JBQ3ZCNkIsYUFBYWhDLEtBQUtnQyxXQUFXO2dCQUM3QkMsV0FBV2pDLEtBQUtpQyxTQUFTO2dCQUN6QkMsYUFBYWxDLEtBQUtrQyxXQUFXO2dCQUM3QkMsU0FBU25DLEtBQUttQyxPQUFPLEVBQUVDO2dCQUN2QkMsVUFBVXJDLEtBQUtxQyxRQUFRLEVBQUVEO2dCQUN6QnBCLFdBQVdoQixLQUFLZ0IsU0FBUyxDQUFDb0IsV0FBVztnQkFDckNuQixXQUFXakIsS0FBS2lCLFNBQVMsQ0FBQ21CLFdBQVc7Z0JBQ3JDL0IsT0FBTztvQkFDTFQsSUFBSUksS0FBS0ssS0FBSyxDQUFDVCxFQUFFO29CQUNqQlcsTUFBTVAsS0FBS0ssS0FBSyxDQUFDRSxJQUFJLElBQUk7b0JBQ3pCQyxPQUFPUixLQUFLSyxLQUFLLENBQUNHLEtBQUs7Z0JBQ3pCO2dCQUNBQyxXQUFXVCxLQUFLUyxTQUFTO2dCQUN6Qk0sV0FBV2YsS0FBS2UsU0FBUztZQUMzQjtRQUVBeEIsUUFBUUMsR0FBRyxDQUFDLENBQUMsWUFBWSxFQUFFcUMsZUFBZVgsTUFBTSxDQUFDLGdCQUFnQixDQUFDO1FBRWxFLE1BQU1HLFdBQVcvQyxxREFBWUEsQ0FBQ2dFLElBQUksQ0FBQ1Q7UUFFbkMsa0NBQWtDO1FBQ2xDLE1BQU1qRCxTQUFTRCxRQUFRRSxPQUFPLENBQUNDLEdBQUcsQ0FBQztRQUNuQyxNQUFNQyxpQkFBaUI7WUFDckJDLFFBQVFDLEdBQUcsQ0FBQ0MsWUFBWSxJQUFJO1lBQzVCO1lBQ0E7U0FDRDtRQUNELE1BQU1DLGlCQUFpQlAsVUFBVUcsZUFBZUssUUFBUSxDQUFDUixVQUFVQSxTQUFTRyxjQUFjLENBQUMsRUFBRTtRQUU3RnNDLFNBQVN4QyxPQUFPLENBQUMwRCxHQUFHLENBQUMsK0JBQStCcEQ7UUFDcERrQyxTQUFTeEMsT0FBTyxDQUFDMEQsR0FBRyxDQUFDLG9DQUFvQztRQUN6RGxCLFNBQVN4QyxPQUFPLENBQUMwRCxHQUFHLENBQUMsZ0NBQWdDO1FBQ3JEbEIsU0FBU3hDLE9BQU8sQ0FBQzBELEdBQUcsQ0FBQyxnQ0FBZ0M7UUFFckQsT0FBT2xCO0lBRVQsRUFBRSxPQUFPbUIsT0FBTztRQUNkakQsUUFBUWlELEtBQUssQ0FBQyxrQ0FBa0NBO1FBQ2hELE9BQU9sRSxxREFBWUEsQ0FBQ2dFLElBQUksQ0FDdEI7WUFBRUUsT0FBTztRQUF3QixHQUNqQztZQUFFbkQsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcm90b21mb3Jtcy1iYWNrZW5kLy4vc3JjL2FwcC9hcGkvZm9ybXMvcHVibGljL3JvdXRlLnRzP2VhZTUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IGdldFNlcnZlclNlc3Npb24gfSBmcm9tICduZXh0LWF1dGgnO1xuaW1wb3J0IHsgYXV0aE9wdGlvbnMgfSBmcm9tICdAL2xpYi9hdXRoJztcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJ0AvbGliL3ByaXNtYSc7XG5cbi8vIEhhbmRsZSBPUFRJT05TIHByZWZsaWdodCByZXF1ZXN0cyBmb3IgQ09SU1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIE9QVElPTlMocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3Qgb3JpZ2luID0gcmVxdWVzdC5oZWFkZXJzLmdldCgnb3JpZ2luJyk7XG4gIGNvbnN0IGFsbG93ZWRPcmlnaW5zID0gW1xuICAgIHByb2Nlc3MuZW52LkZST05URU5EX1VSTCB8fCAnaHR0cDovL2xvY2FsaG9zdDozMDAwJyxcbiAgICAnaHR0cDovL2xvY2FsaG9zdDozMDAwJyxcbiAgICAnaHR0cDovL2xvY2FsaG9zdDozMDAxJ1xuICBdO1xuICBjb25zdCByZXNwb25zZU9yaWdpbiA9IG9yaWdpbiAmJiBhbGxvd2VkT3JpZ2lucy5pbmNsdWRlcyhvcmlnaW4pID8gb3JpZ2luIDogYWxsb3dlZE9yaWdpbnNbMF07XG5cbiAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UobnVsbCwge1xuICAgIHN0YXR1czogMjAwLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nOiByZXNwb25zZU9yaWdpbixcbiAgICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1NZXRob2RzJzogJ0dFVCwgT1BUSU9OUycsXG4gICAgICAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVycyc6ICdDb250ZW50LVR5cGUsIENvb2tpZSwgQXV0aG9yaXphdGlvbicsXG4gICAgICAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctQ3JlZGVudGlhbHMnOiAndHJ1ZScsXG4gICAgICAnQWNjZXNzLUNvbnRyb2wtTWF4LUFnZSc6ICc4NjQwMCcsXG4gICAgfSxcbiAgfSk7XG59XG5cbi8vIEdFVCAvYXBpL2Zvcm1zL3B1YmxpYyAtIEdldCBhbGwgcHVibGljIGZvcm1zIGF2YWlsYWJsZSBmb3IgdXNlcnNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygn8J+TpSBHRVQgL2FwaS9mb3Jtcy9wdWJsaWMgLSBSZXF1ZXN0IHJlY2VpdmVkJyk7XG4gICAgXG4gICAgLy8gTm9uIGJsb2NjYXJlIHNlIGdldFNlcnZlclNlc3Npb24gdmEgaW4gdGltZW91dCAtIHF1ZXN0byBlbmRwb2ludCBkZXZlIGZ1bnppb25hcmUgc2VtcHJlXG4gICAgbGV0IHNlc3Npb24gPSBudWxsO1xuICAgIGxldCB1c2VySWQgPSBudWxsO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBzZXNzaW9uID0gYXdhaXQgZ2V0U2VydmVyU2Vzc2lvbihhdXRoT3B0aW9ucyk7XG4gICAgICB1c2VySWQgPSBzZXNzaW9uPy51c2VyPy5pZDtcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgU2Vzc2lvbiByZXRyaWV2ZWQ6JywgdXNlcklkID8gYFVzZXI6ICR7dXNlcklkfWAgOiAnTm8gc2Vzc2lvbicpO1xuICAgIH0gY2F0Y2ggKHNlc3Npb25FcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gU2Vzc2lvbiBjaGVjayBmYWlsZWQgKG5vbi1jcml0aWNhbCk6Jywgc2Vzc2lvbkVycm9yKTtcbiAgICAgIC8vIENvbnRpbnVhIHNlbnphIHNlc3Npb25lIC0gbCdlbmRwb2ludCBkZXZlIGZ1bnppb25hcmUgYW5jaGUgc2VuemEgYXV0ZW50aWNhemlvbmVcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygn8J+UjSBGZXRjaGluZyBwdWJsaWMgZm9ybXMgZnJvbSBkYXRhYmFzZS4uLicpO1xuICAgIFxuICAgIC8vIEdldCBhbGwgcHVibGljIGZvcm1zIChpc1B1YmxpYzogdHJ1ZSlcbiAgICAvLyBTZSBoYW5ubyBzdGF0dXMgUFVCTElTSEVEIGxpIG1vc3RyaWFtbywgYWx0cmltZW50aSBtb3N0cmlhbW8gY29tdW5xdWUgcXVlbGxpIHB1YmJsaWNpXG4gICAgLy8gUXVlc3RvIHBlcm1ldHRlIHJldHJvY29tcGF0aWJpbGl0w6AgY29uIGZvcm0gY2hlIG5vbiBoYW5ubyBhbmNvcmEgbG8gc3RhdHVzIGltcG9zdGF0b1xuICAgIGNvbnN0IGZvcm1zID0gYXdhaXQgcHJpc21hLmZvcm0uZmluZE1hbnkoe1xuICAgICAgd2hlcmU6IHsgXG4gICAgICAgIGlzUHVibGljOiB0cnVlLFxuICAgICAgICAvLyBOb24gZmlsdHJpYW1vIHBlciBzdGF0dXMgcGVyIHJldHJvY29tcGF0aWJpbGl0w6BcbiAgICAgICAgLy8gTW9zdHJpYW1vIHR1dHRpIGkgZm9ybSBwdWJibGljaSBpbmRpcGVuZGVudGVtZW50ZSBkYWxsbyBzdGF0dXNcbiAgICAgIH0sXG4gICAgICBpbmNsdWRlOiB7XG4gICAgICAgIG93bmVyOiB7XG4gICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgICAgICBlbWFpbDogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcXVlc3Rpb25zOiB7XG4gICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgIHRleHQ6IHRydWUsXG4gICAgICAgICAgICB0eXBlOiB0cnVlLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICBvcmRlcjogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgb3JkZXJCeToge1xuICAgICAgICAgICAgb3JkZXI6ICdhc2MnXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgdXNlcklkOiB0cnVlLFxuICAgICAgICAgICAgY3JlYXRlZEF0OiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb3JkZXJCeToge1xuICAgICAgICB1cGRhdGVkQXQ6ICdkZXNjJ1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc29sZS5sb2coYPCfk4sgRm91bmQgJHtmb3Jtcy5sZW5ndGh9IHB1YmxpYyBmb3Jtc2ApO1xuICAgIFxuICAgIC8vIENoZWNrIGlmIHVzZXIgaGFzIGFscmVhZHkgcmVzcG9uZGVkIHRvIGFueSBmb3JtcyAob25seSBpZiBhdXRoZW50aWNhdGVkKVxuICAgIGxldCBhdmFpbGFibGVGb3JtcyA9IGZvcm1zO1xuICAgIFxuICAgIGlmICh1c2VySWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKGDwn5SNIEZpbHRlcmluZyBmb3JtcyBmb3IgdXNlciAke3VzZXJJZH0uLi5gKTtcbiAgICAgIGNvbnN0IHVzZXJSZXNwb25zZXMgPSBhd2FpdCBwcmlzbWEucmVzcG9uc2UuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyBcbiAgICAgICAgICB1c2VySWQ6IHVzZXJJZFxuICAgICAgICB9LFxuICAgICAgICBzZWxlY3Q6IHsgXG4gICAgICAgICAgZm9ybUlkOiB0cnVlIFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgYW5zd2VyZWRGb3JtSWRzID0gbmV3IFNldCh1c2VyUmVzcG9uc2VzLm1hcChyID0+IHIuZm9ybUlkKSk7XG5cbiAgICAgIC8vIEZpbHRlciBvdXQgZm9ybXMgdGhlIHVzZXIgaGFzIGFscmVhZHkgYW5zd2VyZWRcbiAgICAgIGF2YWlsYWJsZUZvcm1zID0gZm9ybXMuZmlsdGVyKGZvcm0gPT4gIWFuc3dlcmVkRm9ybUlkcy5oYXMoZm9ybS5pZCkpO1xuICAgICAgY29uc29sZS5sb2coYOKchSAke2F2YWlsYWJsZUZvcm1zLmxlbmd0aH0gZm9ybXMgYXZhaWxhYmxlIGZvciB1c2VyICgke2Zvcm1zLmxlbmd0aCAtIGF2YWlsYWJsZUZvcm1zLmxlbmd0aH0gYWxyZWFkeSBhbnN3ZXJlZClgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coJ+KEue+4jyBObyB1c2VyIHNlc3Npb24gLSBzaG93aW5nIGFsbCBwdWJsaWMgZm9ybXMnKTtcbiAgICB9XG5cbiAgICAvLyBGb3JtYXR0YSBpIGRhdGkgcGVyIGlsIGZyb250ZW5kIGluIG1vZG8gY29tcGF0aWJpbGVcbiAgICBjb25zdCBmb3JtYXR0ZWRGb3JtcyA9IGF2YWlsYWJsZUZvcm1zLm1hcChmb3JtID0+ICh7XG4gICAgICBpZDogZm9ybS5pZCxcbiAgICAgIHRpdGxlOiBmb3JtLnRpdGxlLFxuICAgICAgZGVzY3JpcHRpb246IGZvcm0uZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICB0eXBlOiBmb3JtLnR5cGUsXG4gICAgICBpc1B1YmxpYzogZm9ybS5pc1B1YmxpYyxcbiAgICAgIGlzQW5vbnltb3VzOiBmb3JtLmlzQW5vbnltb3VzLFxuICAgICAgYWxsb3dFZGl0OiBmb3JtLmFsbG93RWRpdCxcbiAgICAgIHNob3dSZXN1bHRzOiBmb3JtLnNob3dSZXN1bHRzLFxuICAgICAgb3BlbnNBdDogZm9ybS5vcGVuc0F0Py50b0lTT1N0cmluZygpLFxuICAgICAgY2xvc2VzQXQ6IGZvcm0uY2xvc2VzQXQ/LnRvSVNPU3RyaW5nKCksXG4gICAgICBjcmVhdGVkQXQ6IGZvcm0uY3JlYXRlZEF0LnRvSVNPU3RyaW5nKCksXG4gICAgICB1cGRhdGVkQXQ6IGZvcm0udXBkYXRlZEF0LnRvSVNPU3RyaW5nKCksXG4gICAgICBvd25lcjoge1xuICAgICAgICBpZDogZm9ybS5vd25lci5pZCxcbiAgICAgICAgbmFtZTogZm9ybS5vd25lci5uYW1lIHx8ICdVdGVudGUgU2Nvbm9zY2l1dG8nLFxuICAgICAgICBlbWFpbDogZm9ybS5vd25lci5lbWFpbFxuICAgICAgfSxcbiAgICAgIHF1ZXN0aW9uczogZm9ybS5xdWVzdGlvbnMsXG4gICAgICByZXNwb25zZXM6IGZvcm0ucmVzcG9uc2VzXG4gICAgfSkpO1xuXG4gICAgY29uc29sZS5sb2coYOKchSBSZXR1cm5pbmcgJHtmb3JtYXR0ZWRGb3Jtcy5sZW5ndGh9IGZvcm1hdHRlZCBmb3Jtc2ApO1xuICAgIFxuICAgIGNvbnN0IHJlc3BvbnNlID0gTmV4dFJlc3BvbnNlLmpzb24oZm9ybWF0dGVkRm9ybXMpO1xuICAgIFxuICAgIC8vIEFnZ2l1bmdpIENPUlMgaGVhZGVycyBlc3BsaWNpdGlcbiAgICBjb25zdCBvcmlnaW4gPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdvcmlnaW4nKTtcbiAgICBjb25zdCBhbGxvd2VkT3JpZ2lucyA9IFtcbiAgICAgIHByb2Nlc3MuZW52LkZST05URU5EX1VSTCB8fCAnaHR0cDovL2xvY2FsaG9zdDozMDAwJyxcbiAgICAgICdodHRwOi8vbG9jYWxob3N0OjMwMDAnLFxuICAgICAgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMSdcbiAgICBdO1xuICAgIGNvbnN0IHJlc3BvbnNlT3JpZ2luID0gb3JpZ2luICYmIGFsbG93ZWRPcmlnaW5zLmluY2x1ZGVzKG9yaWdpbikgPyBvcmlnaW4gOiBhbGxvd2VkT3JpZ2luc1swXTtcbiAgICBcbiAgICByZXNwb25zZS5oZWFkZXJzLnNldCgnQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJywgcmVzcG9uc2VPcmlnaW4pO1xuICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1DcmVkZW50aWFscycsICd0cnVlJyk7XG4gICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnLCAnR0VULCBPUFRJT05TJyk7XG4gICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0FjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnMnLCAnQ29udGVudC1UeXBlLCBDb29raWUnKTtcbiAgICBcbiAgICByZXR1cm4gcmVzcG9uc2U7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgZmV0Y2hpbmcgcHVibGljIGZvcm1zOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufSAiXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZ2V0U2VydmVyU2Vzc2lvbiIsImF1dGhPcHRpb25zIiwicHJpc21hIiwiT1BUSU9OUyIsInJlcXVlc3QiLCJvcmlnaW4iLCJoZWFkZXJzIiwiZ2V0IiwiYWxsb3dlZE9yaWdpbnMiLCJwcm9jZXNzIiwiZW52IiwiRlJPTlRFTkRfVVJMIiwicmVzcG9uc2VPcmlnaW4iLCJpbmNsdWRlcyIsInN0YXR1cyIsIkdFVCIsImNvbnNvbGUiLCJsb2ciLCJzZXNzaW9uIiwidXNlcklkIiwidXNlciIsImlkIiwic2Vzc2lvbkVycm9yIiwid2FybiIsImZvcm1zIiwiZm9ybSIsImZpbmRNYW55Iiwid2hlcmUiLCJpc1B1YmxpYyIsImluY2x1ZGUiLCJvd25lciIsInNlbGVjdCIsIm5hbWUiLCJlbWFpbCIsInF1ZXN0aW9ucyIsInRleHQiLCJ0eXBlIiwicmVxdWlyZWQiLCJvcmRlciIsIm9yZGVyQnkiLCJyZXNwb25zZXMiLCJjcmVhdGVkQXQiLCJ1cGRhdGVkQXQiLCJsZW5ndGgiLCJhdmFpbGFibGVGb3JtcyIsInVzZXJSZXNwb25zZXMiLCJyZXNwb25zZSIsImZvcm1JZCIsImFuc3dlcmVkRm9ybUlkcyIsIlNldCIsIm1hcCIsInIiLCJmaWx0ZXIiLCJoYXMiLCJmb3JtYXR0ZWRGb3JtcyIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJpc0Fub255bW91cyIsImFsbG93RWRpdCIsInNob3dSZXN1bHRzIiwib3BlbnNBdCIsInRvSVNPU3RyaW5nIiwiY2xvc2VzQXQiLCJqc29uIiwic2V0IiwiZXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/forms/public/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions),\n/* harmony export */   getAuthSession: () => (/* binding */ getAuthSession)\n/* harmony export */ });\n/* harmony import */ var next_auth_providers_azure_ad__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/providers/azure-ad */ \"(rsc)/./node_modules/next-auth/providers/azure-ad.js\");\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var _auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @auth/prisma-adapter */ \"(rsc)/./node_modules/@auth/prisma-adapter/index.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./src/lib/db.ts\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\n// Configurazione Azure AD - Credenziali hardcoded (App Registration \"POV\")\nconst AZURE_AD_CLIENT_ID = \"0fc2c468-c587-4bae-a99c-e8512c720d94\";\nconst AZURE_AD_CLIENT_SECRET = \"Bbx8Q~lVe0OnN6odfQEC7o7E4SzrRWjOjQMLpbEU\";\nconst AZURE_AD_TENANT_ID = \"94524ed0-9807-4351-bd2e-ba548fd5a31d\";\n// Configurazione NextAuth\nconst NEXTAUTH_SECRET = process.env.NEXTAUTH_SECRET || \"development-secret-key-change-in-production\";\n// In produzione usa HTTPS e il dominio corretto\nconst NEXTAUTH_URL = process.env.NEXTAUTH_URL || ( false ? 0 : \"http://localhost:3001\");\nconst FRONTEND_URL = process.env.FRONTEND_URL || ( false ? 0 : \"http://localhost:3000\");\n// Costruisci il redirect URI per Azure AD (deve corrispondere esattamente a quello configurato in Azure AD)\nconst AZURE_AD_REDIRECT_URI = `${NEXTAUTH_URL}/api/auth/callback/azure-ad`;\n// Validazione in produzione\nif (false) {}\n// Log per debug (sempre attivo per troubleshooting)\nconsole.log(\"\\uD83D\\uDD10 Azure AD Configuration:\", {\n    clientId: `${AZURE_AD_CLIENT_ID.substring(0, 10)}...${AZURE_AD_CLIENT_ID.substring(AZURE_AD_CLIENT_ID.length - 4)}`,\n    tenantId: AZURE_AD_TENANT_ID,\n    redirectUri: AZURE_AD_REDIRECT_URI,\n    nextAuthUrl: NEXTAUTH_URL,\n    frontendUrl: FRONTEND_URL,\n    status: \"âœ… Configured with hardcoded credentials\",\n    expectedRedirectUri: \"http://localhost:3001/api/auth/callback/azure-ad\"\n});\nconst authOptions = {\n    adapter: (0,_auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_2__.PrismaAdapter)(_lib_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"]),\n    // Configurazione URL base - importante per determinare correttamente gli URL\n    // NextAuth usa questa per costruire i redirect URI e i link CSRF\n    // In produzione deve essere HTTPS\n    url: NEXTAUTH_URL,\n    // Permetti il collegamento automatico di account OAuth con stessa email\n    // Questo risolve l'errore OAuthAccountNotLinked\n    // Nota: allowDangerousEmailAccountLinking non Ã¨ disponibile in NextAuth v4, gestito nel callback signIn\n    providers: [\n        // Azure AD Provider\n        (0,next_auth_providers_azure_ad__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            clientId: AZURE_AD_CLIENT_ID,\n            clientSecret: AZURE_AD_CLIENT_SECRET,\n            tenantId: AZURE_AD_TENANT_ID,\n            authorization: {\n                params: {\n                    scope: \"openid profile email\",\n                    response_type: \"code\",\n                    response_mode: \"query\",\n                    prompt: \"select_account\"\n                }\n            },\n            // Usa sia state che PKCE per sicurezza\n            // PKCE Ã¨ richiesto da Azure AD per applicazioni pubbliche\n            checks: [\n                \"pkce\",\n                \"state\"\n            ],\n            profile (profile) {\n                console.log(\"\\uD83D\\uDCCB Azure AD Profile received:\", {\n                    sub: profile.sub,\n                    name: profile.name,\n                    email: profile.email,\n                    preferred_username: profile.preferred_username\n                });\n                return {\n                    id: profile.sub,\n                    name: profile.name,\n                    email: profile.email || profile.preferred_username,\n                    image: profile.picture\n                };\n            }\n        }),\n        // Credentials Provider per login email/password\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            name: \"credentials\",\n            credentials: {\n                email: {\n                    label: \"Email\",\n                    type: \"email\"\n                },\n                password: {\n                    label: \"Password\",\n                    type: \"password\"\n                }\n            },\n            async authorize (credentials) {\n                if (!credentials?.email || !credentials?.password) {\n                    return null;\n                }\n                const user = await _lib_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                    where: {\n                        email: credentials.email\n                    }\n                });\n                if (!user || !user.password) {\n                    return null;\n                }\n                const isPasswordValid = await bcryptjs__WEBPACK_IMPORTED_MODULE_4__[\"default\"].compare(credentials.password, user.password);\n                if (!isPasswordValid) {\n                    return null;\n                }\n                return {\n                    id: user.id,\n                    email: user.email,\n                    name: user.name,\n                    role: user.role\n                };\n            }\n        })\n    ],\n    callbacks: {\n        async signIn ({ user, account, profile }) {\n            // Verifica se l'utente Ã¨ nuovo controllando nel database\n            const existingUser = await _lib_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                where: {\n                    email: user.email\n                }\n            });\n            const isNewUser = !existingUser;\n            console.log(\"\\uD83D\\uDD35 signIn callback called:\", {\n                provider: account?.provider,\n                isNewUser,\n                userEmail: user.email,\n                hasAccount: !!account,\n                hasProfile: !!profile\n            });\n            if (account?.provider === \"azure-ad\") {\n                try {\n                    console.log(\"Azure AD Sign In - Account:\", {\n                        provider: account.provider,\n                        type: account.type,\n                        providerAccountId: account.providerAccountId\n                    });\n                    console.log(\"Azure AD Sign In - User:\", {\n                        id: user.id,\n                        email: user.email,\n                        name: user.name\n                    });\n                    console.log(\"Azure AD Sign In - Profile:\", {\n                        email: profile?.email,\n                        preferred_username: profile?.preferred_username,\n                        sub: profile?.sub\n                    });\n                    // Ensure email is available\n                    const userEmail = user.email || profile?.email || profile?.preferred_username;\n                    if (!userEmail) {\n                        console.error(\"No email found in Azure AD profile\");\n                        return false;\n                    }\n                    const existingUser = await _lib_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                        where: {\n                            email: userEmail\n                        }\n                    });\n                    // Determina il ruolo - solo ludovica.luongo@protom.com e admin@protom.com sono admin\n                    // Tutti gli altri utenti (inclusi quelli che fanno autenticazione con tenant) sono USER\n                    const role = userEmail === \"ludovica.luongo@protom.com\" || userEmail === \"admin@protom.com\" ? _prisma_client__WEBPACK_IMPORTED_MODULE_5__.Role.ADMIN : _prisma_client__WEBPACK_IMPORTED_MODULE_5__.Role.USER;\n                    if (existingUser) {\n                        // Utente esiste giÃ  - collega manualmente l'account OAuth\n                        console.log(\"\\uD83D\\uDD17 Linking OAuth account to existing user:\", existingUser.email);\n                        // Verifica se l'account OAuth Ã¨ giÃ  collegato\n                        const existingAccount = await _lib_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].account.findFirst({\n                            where: {\n                                userId: existingUser.id,\n                                provider: \"azure-ad\",\n                                providerAccountId: account.providerAccountId\n                            }\n                        });\n                        if (!existingAccount) {\n                            // Crea il collegamento Account per l'utente esistente\n                            await _lib_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].account.create({\n                                data: {\n                                    userId: existingUser.id,\n                                    type: account.type,\n                                    provider: account.provider,\n                                    providerAccountId: account.providerAccountId,\n                                    refresh_token: account.refresh_token,\n                                    access_token: account.access_token,\n                                    expires_at: account.expires_at,\n                                    token_type: account.token_type,\n                                    scope: account.scope,\n                                    id_token: account.id_token,\n                                    session_state: account.session_state\n                                }\n                            });\n                            console.log(\"âœ… OAuth account linked successfully\");\n                        } else {\n                            // Aggiorna l'account esistente con nuovi token\n                            await _lib_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].account.update({\n                                where: {\n                                    id: existingAccount.id\n                                },\n                                data: {\n                                    refresh_token: account.refresh_token,\n                                    access_token: account.access_token,\n                                    expires_at: account.expires_at,\n                                    token_type: account.token_type,\n                                    scope: account.scope,\n                                    id_token: account.id_token,\n                                    session_state: account.session_state\n                                }\n                            });\n                            console.log(\"âœ… OAuth account updated with new tokens\");\n                        }\n                        // Aggiorna ruolo e nome se necessario\n                        await _lib_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.update({\n                            where: {\n                                id: existingUser.id\n                            },\n                            data: {\n                                role,\n                                name: user.name || existingUser.name\n                            }\n                        });\n                        // Imposta l'ID utente per NextAuth\n                        user.id = existingUser.id;\n                        console.log(\"âœ… Existing user updated and account linked\");\n                    } else {\n                        // Utente non esiste - crea manualmente perchÃ© PrismaAdapter fallisce senza emailVerified\n                        console.log(\"âœ… New user - creating manually (PrismaAdapter doesn't support emailVerified in our schema)\");\n                        // Crea l'utente manualmente (senza emailVerified che non esiste nello schema)\n                        const newUser = await _lib_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.create({\n                            data: {\n                                email: userEmail,\n                                name: user.name || null,\n                                role: role\n                            }\n                        });\n                        // Crea l'account OAuth collegato\n                        await _lib_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].account.create({\n                            data: {\n                                userId: newUser.id,\n                                type: account.type,\n                                provider: account.provider,\n                                providerAccountId: account.providerAccountId,\n                                refresh_token: account.refresh_token,\n                                access_token: account.access_token,\n                                expires_at: account.expires_at,\n                                token_type: account.token_type,\n                                scope: account.scope,\n                                id_token: account.id_token,\n                                session_state: account.session_state\n                            }\n                        });\n                        // Imposta l'ID utente per NextAuth\n                        user.id = newUser.id;\n                        console.log(\"âœ… New user and OAuth account created successfully\");\n                    }\n                    return true;\n                } catch (error) {\n                    console.error(\"âŒ Error during Azure AD sign in callback:\", error);\n                    console.error(\"Error details:\", {\n                        message: error instanceof Error ? error.message : String(error),\n                        stack: error instanceof Error ? error.stack : undefined,\n                        userEmail: user.email,\n                        profileEmail: profile?.email,\n                        account: account ? {\n                            provider: account.provider,\n                            type: account.type\n                        } : null\n                    });\n                    return false;\n                }\n            }\n            return true;\n        },\n        async jwt ({ token, user, account, trigger }) {\n            console.log(\"\\uD83C\\uDFAB JWT callback:\", {\n                trigger,\n                hasUser: !!user,\n                hasAccount: !!account,\n                provider: account?.provider,\n                userEmail: token.email,\n                userId: user?.id || token.id\n            });\n            if (user) {\n                token.id = user.id;\n                token.role = user.role;\n                console.log(\"âœ… User data added to token:\", {\n                    id: user.id,\n                    role: user.role\n                });\n            }\n            // Recupera il ruolo dal database se non presente\n            if (account && !token.role && token.email) {\n                try {\n                    console.log(\"\\uD83D\\uDD0D Fetching user from DB:\", token.email);\n                    const dbUser = await _lib_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].user.findUnique({\n                        where: {\n                            email: token.email\n                        }\n                    });\n                    if (dbUser) {\n                        token.id = dbUser.id;\n                        token.role = dbUser.role;\n                        console.log(\"âœ… User found in DB:\", {\n                            id: dbUser.id,\n                            role: dbUser.role\n                        });\n                    } else {\n                        console.warn(\"âš ï¸ User not found in DB:\", token.email);\n                    }\n                } catch (error) {\n                    console.error(\"âŒ Error fetching user in jwt callback:\", error);\n                }\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            if (session.user) {\n                session.user.id = token.id;\n                session.user.role = token.role;\n            }\n            return session;\n        },\n        async redirect ({ url, baseUrl }) {\n            // baseUrl Ã¨ NEXTAUTH_URL (http://localhost:3001)\n            // url puÃ² essere il callbackUrl passato o il default di NextAuth\n            console.log(\"\\uD83D\\uDD04 Redirect callback called:\", {\n                url,\n                baseUrl,\n                frontendUrl: FRONTEND_URL,\n                urlIsBaseUrl: url === baseUrl,\n                urlIsRoot: url === baseUrl + \"/\" || url === \"/\",\n                urlType: typeof url,\n                urlLength: url?.length\n            });\n            // SEMPRE reindirizza al frontend - anche se url contiene il callbackUrl corretto\n            // ma potrebbe essere un URL del backend che vogliamo convertire\n            // Se l'URL Ã¨ la root del backend o il baseUrl stesso o vuoto, reindirizza sempre alla dashboard\n            if (!url || url === \"\" || url === baseUrl || url === baseUrl + \"/\" || url === \"/\") {\n                console.log(\"âœ… URL is backend root or empty, redirecting to frontend dashboard\");\n                return `${FRONTEND_URL}/admin/dashboard`;\n            }\n            // Se l'URL Ã¨ un URL completo del frontend, usa quello direttamente\n            if (url.startsWith(FRONTEND_URL)) {\n                console.log(\"âœ… URL is already frontend URL, using it:\", url);\n                return url;\n            }\n            // Se l'URL inizia con baseUrl (backend), sostituisci con frontend\n            // Esempio: http://localhost:3001/admin/dashboard -> http://localhost:3000/admin/dashboard\n            if (url.startsWith(baseUrl)) {\n                const path = url.replace(baseUrl, \"\");\n                const redirectUrl = `${FRONTEND_URL}${path || \"/admin/dashboard\"}`;\n                console.log(\"âœ… Converting backend URL to frontend:\", {\n                    original: url,\n                    path,\n                    redirectUrl\n                });\n                return redirectUrl;\n            }\n            // Se Ã¨ un percorso relativo che inizia con /, aggiungi al frontend\n            // Esempio: /admin/dashboard -> http://localhost:3000/admin/dashboard\n            if (url.startsWith(\"/\")) {\n                // Rimuovi eventuali query params dal percorso se presenti\n                const path = url.split(\"?\")[0];\n                const redirectUrl = `${FRONTEND_URL}${path}`;\n                console.log(\"âœ… Converting relative path to frontend URL:\", {\n                    original: url,\n                    path,\n                    redirectUrl\n                });\n                return redirectUrl;\n            }\n            // Se l'URL Ã¨ un URL completo che non inizia con baseUrl o FRONTEND_URL\n            // potrebbe essere un URL esterno, ma per sicurezza reindirizziamo alla dashboard\n            if (url.startsWith(\"http://\") || url.startsWith(\"https://\")) {\n                console.log(\"âš ï¸ URL is external, redirecting to frontend dashboard for security:\", url);\n                return `${FRONTEND_URL}/admin/dashboard`;\n            }\n            // Fallback finale: reindirizza sempre alla dashboard del frontend\n            console.log(\"âœ… Default fallback: redirecting to frontend dashboard\");\n            return `${FRONTEND_URL}/admin/dashboard`;\n        }\n    },\n    pages: {\n        // NON configuriamo signIn qui - NextAuth deve reindirizzare direttamente ad Azure AD\n        // Se configuriamo signIn, NextAuth reindirizza alla pagina invece che al provider\n        error: `${FRONTEND_URL}/auth/error`\n    },\n    // Callback per gestire gli errori e reindirizzare correttamente\n    events: {\n        async signIn ({ user, account, profile }) {\n            console.log(\"âœ… Sign in successful:\", {\n                user: user.email,\n                provider: account?.provider\n            });\n        },\n        async signOut () {\n            console.log(\"\\uD83D\\uDC4B User signed out\");\n        }\n    },\n    session: {\n        strategy: \"jwt\",\n        maxAge: 30 * 24 * 60 * 60\n    },\n    cookies: {\n        sessionToken: {\n            name: `${ false ? 0 : \"\"}next-auth.session-token`,\n            options: {\n                httpOnly: true,\n                sameSite:  false ? 0 : \"lax\",\n                path: \"/\",\n                secure: \"development\" === \"production\"\n            }\n        },\n        callbackUrl: {\n            name: `${ false ? 0 : \"\"}next-auth.callback-url`,\n            options: {\n                httpOnly: true,\n                sameSite:  false ? 0 : \"lax\",\n                path: \"/\",\n                secure: \"development\" === \"production\"\n            }\n        },\n        csrfToken: {\n            name: `${ false ? 0 : \"\"}next-auth.csrf-token`,\n            options: {\n                httpOnly: true,\n                sameSite:  false ? 0 : \"lax\",\n                path: \"/\",\n                secure: \"development\" === \"production\"\n            }\n        }\n    },\n    secret: NEXTAUTH_SECRET,\n    debug: true,\n    logger: {\n        error (code, metadata) {\n            console.error(\"\\uD83D\\uDD34 NextAuth Error:\", {\n                code,\n                metadata,\n                timestamp: new Date().toISOString()\n            });\n        },\n        warn (code) {\n            console.warn(\"âš ï¸ NextAuth Warning:\", code);\n        },\n        debug (code, metadata) {\n            console.log(\"\\uD83D\\uDC1B NextAuth Debug:\", {\n                code,\n                metadata,\n                timestamp: new Date().toISOString()\n            });\n        }\n    }\n};\nconst getAuthSession = ()=>{\n    return (0,next_auth__WEBPACK_IMPORTED_MODULE_6__.getServerSession)(authOptions);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1lBQ25DO1FBQ0Y7UUFDQWxDLE1BQUs4QixJQUFJO1lBQ1A1RyxRQUFROEUsSUFBSSxDQUFDLHdCQUF3QjhCO1FBQ3ZDO1FBQ0FGLE9BQU1FLElBQUksRUFBRUMsUUFBUTtZQUNsQjdHLFFBQVFDLEdBQUcsQ0FBQyxnQ0FBc0I7Z0JBQ2hDMkc7Z0JBQ0FDO2dCQUNBQyxXQUFXLElBQUlDLE9BQU9DLFdBQVc7WUFDbkM7UUFDRjtJQUNGO0FBQ0YsRUFBRTtBQUVLLE1BQU1DLGlCQUFpQjtJQUM1QixPQUFPNUgsMkRBQWdCQSxDQUFDc0I7QUFDMUIsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3Byb3RvbWZvcm1zLWJhY2tlbmQvLi9zcmMvbGliL2F1dGgudHM/NjY5MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXV0aE9wdGlvbnMgfSBmcm9tICduZXh0LWF1dGgnO1xuaW1wb3J0IEF6dXJlQURQcm92aWRlciBmcm9tICduZXh0LWF1dGgvcHJvdmlkZXJzL2F6dXJlLWFkJztcbmltcG9ydCBDcmVkZW50aWFsc1Byb3ZpZGVyIGZyb20gJ25leHQtYXV0aC9wcm92aWRlcnMvY3JlZGVudGlhbHMnO1xuaW1wb3J0IHsgUHJpc21hQWRhcHRlciB9IGZyb20gJ0BhdXRoL3ByaXNtYS1hZGFwdGVyJztcbmltcG9ydCBwcmlzbWEgZnJvbSAnQC9saWIvZGInO1xuaW1wb3J0IGJjcnlwdCBmcm9tICdiY3J5cHRqcyc7XG5pbXBvcnQgeyBSb2xlIH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuaW1wb3J0IHsgZ2V0U2VydmVyU2Vzc2lvbiB9IGZyb20gXCJuZXh0LWF1dGhcIjtcblxuLy8gQ29uZmlndXJhemlvbmUgQXp1cmUgQUQgLSBDcmVkZW56aWFsaSBoYXJkY29kZWQgKEFwcCBSZWdpc3RyYXRpb24gXCJQT1ZcIilcbmNvbnN0IEFaVVJFX0FEX0NMSUVOVF9JRCA9ICcwZmMyYzQ2OC1jNTg3LTRiYWUtYTk5Yy1lODUxMmM3MjBkOTQnO1xuY29uc3QgQVpVUkVfQURfQ0xJRU5UX1NFQ1JFVCA9ICdCYng4UX5sVmUwT25ONm9kZlFFQzdvN0U0U3pyUldqT2pRTUxwYkVVJztcbmNvbnN0IEFaVVJFX0FEX1RFTkFOVF9JRCA9ICc5NDUyNGVkMC05ODA3LTQzNTEtYmQyZS1iYTU0OGZkNWEzMWQnO1xuXG4vLyBDb25maWd1cmF6aW9uZSBOZXh0QXV0aFxuY29uc3QgTkVYVEFVVEhfU0VDUkVUID0gcHJvY2Vzcy5lbnYuTkVYVEFVVEhfU0VDUkVUIHx8ICdkZXZlbG9wbWVudC1zZWNyZXQta2V5LWNoYW5nZS1pbi1wcm9kdWN0aW9uJztcbi8vIEluIHByb2R1emlvbmUgdXNhIEhUVFBTIGUgaWwgZG9taW5pbyBjb3JyZXR0b1xuY29uc3QgTkVYVEFVVEhfVVJMID0gcHJvY2Vzcy5lbnYuTkVYVEFVVEhfVVJMIHx8IFxuICAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICdodHRwczovL3Bvdi5wcm90b20uY29tJyA6ICdodHRwOi8vbG9jYWxob3N0OjMwMDEnKTtcbmNvbnN0IEZST05URU5EX1VSTCA9IHByb2Nlc3MuZW52LkZST05URU5EX1VSTCB8fCBcbiAgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyAnaHR0cHM6Ly9wb3YucHJvdG9tLmNvbScgOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwJyk7XG5cbi8vIENvc3RydWlzY2kgaWwgcmVkaXJlY3QgVVJJIHBlciBBenVyZSBBRCAoZGV2ZSBjb3JyaXNwb25kZXJlIGVzYXR0YW1lbnRlIGEgcXVlbGxvIGNvbmZpZ3VyYXRvIGluIEF6dXJlIEFEKVxuY29uc3QgQVpVUkVfQURfUkVESVJFQ1RfVVJJID0gYCR7TkVYVEFVVEhfVVJMfS9hcGkvYXV0aC9jYWxsYmFjay9henVyZS1hZGA7XG5cbi8vIFZhbGlkYXppb25lIGluIHByb2R1emlvbmVcbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nKSB7XG4gIGlmICghcHJvY2Vzcy5lbnYuTkVYVEFVVEhfU0VDUkVUKSB0aHJvdyBuZXcgRXJyb3IoXCJORVhUQVVUSF9TRUNSRVQgaXMgcmVxdWlyZWRcIik7XG59XG5cbi8vIExvZyBwZXIgZGVidWcgKHNlbXByZSBhdHRpdm8gcGVyIHRyb3VibGVzaG9vdGluZylcbmNvbnNvbGUubG9nKCfwn5SQIEF6dXJlIEFEIENvbmZpZ3VyYXRpb246Jywge1xuICBjbGllbnRJZDogYCR7QVpVUkVfQURfQ0xJRU5UX0lELnN1YnN0cmluZygwLCAxMCl9Li4uJHtBWlVSRV9BRF9DTElFTlRfSUQuc3Vic3RyaW5nKEFaVVJFX0FEX0NMSUVOVF9JRC5sZW5ndGggLSA0KX1gLFxuICB0ZW5hbnRJZDogQVpVUkVfQURfVEVOQU5UX0lELFxuICByZWRpcmVjdFVyaTogQVpVUkVfQURfUkVESVJFQ1RfVVJJLFxuICBuZXh0QXV0aFVybDogTkVYVEFVVEhfVVJMLFxuICBmcm9udGVuZFVybDogRlJPTlRFTkRfVVJMLFxuICBzdGF0dXM6ICfinIUgQ29uZmlndXJlZCB3aXRoIGhhcmRjb2RlZCBjcmVkZW50aWFscycsXG4gIGV4cGVjdGVkUmVkaXJlY3RVcmk6ICdodHRwOi8vbG9jYWxob3N0OjMwMDEvYXBpL2F1dGgvY2FsbGJhY2svYXp1cmUtYWQnXG59KTtcblxuZXhwb3J0IGNvbnN0IGF1dGhPcHRpb25zOiBOZXh0QXV0aE9wdGlvbnMgPSB7XG4gIGFkYXB0ZXI6IFByaXNtYUFkYXB0ZXIocHJpc21hKSBhcyBhbnksXG4gIFxuICAvLyBDb25maWd1cmF6aW9uZSBVUkwgYmFzZSAtIGltcG9ydGFudGUgcGVyIGRldGVybWluYXJlIGNvcnJldHRhbWVudGUgZ2xpIFVSTFxuICAvLyBOZXh0QXV0aCB1c2EgcXVlc3RhIHBlciBjb3N0cnVpcmUgaSByZWRpcmVjdCBVUkkgZSBpIGxpbmsgQ1NSRlxuICAvLyBJbiBwcm9kdXppb25lIGRldmUgZXNzZXJlIEhUVFBTXG4gIHVybDogTkVYVEFVVEhfVVJMLFxuICBcbiAgLy8gUGVybWV0dGkgaWwgY29sbGVnYW1lbnRvIGF1dG9tYXRpY28gZGkgYWNjb3VudCBPQXV0aCBjb24gc3Rlc3NhIGVtYWlsXG4gIC8vIFF1ZXN0byByaXNvbHZlIGwnZXJyb3JlIE9BdXRoQWNjb3VudE5vdExpbmtlZFxuICAvLyBOb3RhOiBhbGxvd0Rhbmdlcm91c0VtYWlsQWNjb3VudExpbmtpbmcgbm9uIMOoIGRpc3BvbmliaWxlIGluIE5leHRBdXRoIHY0LCBnZXN0aXRvIG5lbCBjYWxsYmFjayBzaWduSW5cbiAgXG4gIHByb3ZpZGVyczogW1xuICAgIC8vIEF6dXJlIEFEIFByb3ZpZGVyXG4gICAgQXp1cmVBRFByb3ZpZGVyKHtcbiAgICAgIGNsaWVudElkOiBBWlVSRV9BRF9DTElFTlRfSUQsXG4gICAgICBjbGllbnRTZWNyZXQ6IEFaVVJFX0FEX0NMSUVOVF9TRUNSRVQsXG4gICAgICB0ZW5hbnRJZDogQVpVUkVfQURfVEVOQU5UX0lELFxuICAgICAgYXV0aG9yaXphdGlvbjoge1xuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBzY29wZTogXCJvcGVuaWQgcHJvZmlsZSBlbWFpbFwiLFxuICAgICAgICAgIHJlc3BvbnNlX3R5cGU6IFwiY29kZVwiLFxuICAgICAgICAgIHJlc3BvbnNlX21vZGU6IFwicXVlcnlcIixcbiAgICAgICAgICBwcm9tcHQ6IFwic2VsZWN0X2FjY291bnRcIlxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLy8gVXNhIHNpYSBzdGF0ZSBjaGUgUEtDRSBwZXIgc2ljdXJlenphXG4gICAgICAvLyBQS0NFIMOoIHJpY2hpZXN0byBkYSBBenVyZSBBRCBwZXIgYXBwbGljYXppb25pIHB1YmJsaWNoZVxuICAgICAgY2hlY2tzOiBbXCJwa2NlXCIsIFwic3RhdGVcIl0sXG4gICAgICBwcm9maWxlKHByb2ZpbGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCLwn5OLIEF6dXJlIEFEIFByb2ZpbGUgcmVjZWl2ZWQ6XCIsIHtcbiAgICAgICAgICBzdWI6IHByb2ZpbGUuc3ViLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBwcmVmZXJyZWRfdXNlcm5hbWU6IChwcm9maWxlIGFzIGFueSkucHJlZmVycmVkX3VzZXJuYW1lLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5zdWIsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsIHx8IChwcm9maWxlIGFzIGFueSkucHJlZmVycmVkX3VzZXJuYW1lLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLnBpY3R1cmUsXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KSxcbiAgICBcbiAgICAvLyBDcmVkZW50aWFscyBQcm92aWRlciBwZXIgbG9naW4gZW1haWwvcGFzc3dvcmRcbiAgICBDcmVkZW50aWFsc1Byb3ZpZGVyKHtcbiAgICAgIG5hbWU6IFwiY3JlZGVudGlhbHNcIixcbiAgICAgIGNyZWRlbnRpYWxzOiB7XG4gICAgICAgIGVtYWlsOiB7IGxhYmVsOiBcIkVtYWlsXCIsIHR5cGU6IFwiZW1haWxcIiB9LFxuICAgICAgICBwYXNzd29yZDogeyBsYWJlbDogXCJQYXNzd29yZFwiLCB0eXBlOiBcInBhc3N3b3JkXCIgfSxcbiAgICAgIH0sXG4gICAgICBhc3luYyBhdXRob3JpemUoY3JlZGVudGlhbHMpIHtcbiAgICAgICAgaWYgKCFjcmVkZW50aWFscz8uZW1haWwgfHwgIWNyZWRlbnRpYWxzPy5wYXNzd29yZCkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgICAgIHdoZXJlOiB7IGVtYWlsOiBjcmVkZW50aWFscy5lbWFpbCB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIXVzZXIgfHwgIXVzZXIucGFzc3dvcmQpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlzUGFzc3dvcmRWYWxpZCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKGNyZWRlbnRpYWxzLnBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKTtcblxuICAgICAgICBpZiAoIWlzUGFzc3dvcmRWYWxpZCkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICAgICAgcm9sZTogdXNlci5yb2xlLFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9KSxcbiAgXSxcblxuICBjYWxsYmFja3M6IHtcbiAgICBhc3luYyBzaWduSW4oeyB1c2VyLCBhY2NvdW50LCBwcm9maWxlIH0pIHtcbiAgICAgIC8vIFZlcmlmaWNhIHNlIGwndXRlbnRlIMOoIG51b3ZvIGNvbnRyb2xsYW5kbyBuZWwgZGF0YWJhc2VcbiAgICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBlbWFpbDogdXNlci5lbWFpbCEgfVxuICAgICAgfSk7XG4gICAgICBjb25zdCBpc05ld1VzZXIgPSAhZXhpc3RpbmdVc2VyO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhcIvCflLUgc2lnbkluIGNhbGxiYWNrIGNhbGxlZDpcIiwge1xuICAgICAgICBwcm92aWRlcjogYWNjb3VudD8ucHJvdmlkZXIsXG4gICAgICAgIGlzTmV3VXNlcixcbiAgICAgICAgdXNlckVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICBoYXNBY2NvdW50OiAhIWFjY291bnQsXG4gICAgICAgIGhhc1Byb2ZpbGU6ICEhcHJvZmlsZVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGlmIChhY2NvdW50Py5wcm92aWRlciA9PT0gXCJhenVyZS1hZFwiKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJBenVyZSBBRCBTaWduIEluIC0gQWNjb3VudDpcIiwge1xuICAgICAgICAgICAgcHJvdmlkZXI6IGFjY291bnQucHJvdmlkZXIsXG4gICAgICAgICAgICB0eXBlOiBhY2NvdW50LnR5cGUsXG4gICAgICAgICAgICBwcm92aWRlckFjY291bnRJZDogYWNjb3VudC5wcm92aWRlckFjY291bnRJZFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiQXp1cmUgQUQgU2lnbiBJbiAtIFVzZXI6XCIsIHtcbiAgICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICBuYW1lOiB1c2VyLm5hbWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIkF6dXJlIEFEIFNpZ24gSW4gLSBQcm9maWxlOlwiLCB7XG4gICAgICAgICAgICBlbWFpbDogKHByb2ZpbGUgYXMgYW55KT8uZW1haWwsXG4gICAgICAgICAgICBwcmVmZXJyZWRfdXNlcm5hbWU6IChwcm9maWxlIGFzIGFueSk/LnByZWZlcnJlZF91c2VybmFtZSxcbiAgICAgICAgICAgIHN1YjogKHByb2ZpbGUgYXMgYW55KT8uc3ViXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gRW5zdXJlIGVtYWlsIGlzIGF2YWlsYWJsZVxuICAgICAgICAgIGNvbnN0IHVzZXJFbWFpbCA9IHVzZXIuZW1haWwgfHwgKHByb2ZpbGUgYXMgYW55KT8uZW1haWwgfHwgKHByb2ZpbGUgYXMgYW55KT8ucHJlZmVycmVkX3VzZXJuYW1lO1xuICAgICAgICAgIGlmICghdXNlckVtYWlsKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiTm8gZW1haWwgZm91bmQgaW4gQXp1cmUgQUQgcHJvZmlsZVwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICAgICAgICAgIHdoZXJlOiB7IGVtYWlsOiB1c2VyRW1haWwgfSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIERldGVybWluYSBpbCBydW9sbyAtIHNvbG8gbHVkb3ZpY2EubHVvbmdvQHByb3RvbS5jb20gZSBhZG1pbkBwcm90b20uY29tIHNvbm8gYWRtaW5cbiAgICAgICAgICAvLyBUdXR0aSBnbGkgYWx0cmkgdXRlbnRpIChpbmNsdXNpIHF1ZWxsaSBjaGUgZmFubm8gYXV0ZW50aWNhemlvbmUgY29uIHRlbmFudCkgc29ubyBVU0VSXG4gICAgICAgICAgY29uc3Qgcm9sZSA9IChcbiAgICAgICAgICAgIHVzZXJFbWFpbCA9PT0gJ2x1ZG92aWNhLmx1b25nb0Bwcm90b20uY29tJyB8fCBcbiAgICAgICAgICAgIHVzZXJFbWFpbCA9PT0gJ2FkbWluQHByb3RvbS5jb20nXG4gICAgICAgICAgKSBcbiAgICAgICAgICAgID8gUm9sZS5BRE1JTiBcbiAgICAgICAgICAgIDogUm9sZS5VU0VSO1xuXG4gICAgICAgICAgaWYgKGV4aXN0aW5nVXNlcikge1xuICAgICAgICAgICAgLy8gVXRlbnRlIGVzaXN0ZSBnacOgIC0gY29sbGVnYSBtYW51YWxtZW50ZSBsJ2FjY291bnQgT0F1dGhcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi8J+UlyBMaW5raW5nIE9BdXRoIGFjY291bnQgdG8gZXhpc3RpbmcgdXNlcjpcIiwgZXhpc3RpbmdVc2VyLmVtYWlsKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVmVyaWZpY2Egc2UgbCdhY2NvdW50IE9BdXRoIMOoIGdpw6AgY29sbGVnYXRvXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0FjY291bnQgPSBhd2FpdCBwcmlzbWEuYWNjb3VudC5maW5kRmlyc3Qoe1xuICAgICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICAgIHVzZXJJZDogZXhpc3RpbmdVc2VyLmlkLFxuICAgICAgICAgICAgICAgIHByb3ZpZGVyOiAnYXp1cmUtYWQnLFxuICAgICAgICAgICAgICAgIHByb3ZpZGVyQWNjb3VudElkOiBhY2NvdW50LnByb3ZpZGVyQWNjb3VudElkXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoIWV4aXN0aW5nQWNjb3VudCkge1xuICAgICAgICAgICAgICAvLyBDcmVhIGlsIGNvbGxlZ2FtZW50byBBY2NvdW50IHBlciBsJ3V0ZW50ZSBlc2lzdGVudGVcbiAgICAgICAgICAgICAgYXdhaXQgcHJpc21hLmFjY291bnQuY3JlYXRlKHtcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICB1c2VySWQ6IGV4aXN0aW5nVXNlci5pZCxcbiAgICAgICAgICAgICAgICAgIHR5cGU6IGFjY291bnQudHlwZSxcbiAgICAgICAgICAgICAgICAgIHByb3ZpZGVyOiBhY2NvdW50LnByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgcHJvdmlkZXJBY2NvdW50SWQ6IGFjY291bnQucHJvdmlkZXJBY2NvdW50SWQsXG4gICAgICAgICAgICAgICAgICByZWZyZXNoX3Rva2VuOiBhY2NvdW50LnJlZnJlc2hfdG9rZW4sXG4gICAgICAgICAgICAgICAgICBhY2Nlc3NfdG9rZW46IGFjY291bnQuYWNjZXNzX3Rva2VuLFxuICAgICAgICAgICAgICAgICAgZXhwaXJlc19hdDogYWNjb3VudC5leHBpcmVzX2F0LFxuICAgICAgICAgICAgICAgICAgdG9rZW5fdHlwZTogYWNjb3VudC50b2tlbl90eXBlLFxuICAgICAgICAgICAgICAgICAgc2NvcGU6IGFjY291bnQuc2NvcGUsXG4gICAgICAgICAgICAgICAgICBpZF90b2tlbjogYWNjb3VudC5pZF90b2tlbixcbiAgICAgICAgICAgICAgICAgIHNlc3Npb25fc3RhdGU6IChhY2NvdW50IGFzIGFueSkuc2Vzc2lvbl9zdGF0ZSxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuKchSBPQXV0aCBhY2NvdW50IGxpbmtlZCBzdWNjZXNzZnVsbHlcIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvLyBBZ2dpb3JuYSBsJ2FjY291bnQgZXNpc3RlbnRlIGNvbiBudW92aSB0b2tlblxuICAgICAgICAgICAgICBhd2FpdCBwcmlzbWEuYWNjb3VudC51cGRhdGUoe1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBleGlzdGluZ0FjY291bnQuaWQgfSxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICByZWZyZXNoX3Rva2VuOiBhY2NvdW50LnJlZnJlc2hfdG9rZW4sXG4gICAgICAgICAgICAgICAgICBhY2Nlc3NfdG9rZW46IGFjY291bnQuYWNjZXNzX3Rva2VuLFxuICAgICAgICAgICAgICAgICAgZXhwaXJlc19hdDogYWNjb3VudC5leHBpcmVzX2F0LFxuICAgICAgICAgICAgICAgICAgdG9rZW5fdHlwZTogYWNjb3VudC50b2tlbl90eXBlLFxuICAgICAgICAgICAgICAgICAgc2NvcGU6IGFjY291bnQuc2NvcGUsXG4gICAgICAgICAgICAgICAgICBpZF90b2tlbjogYWNjb3VudC5pZF90b2tlbixcbiAgICAgICAgICAgICAgICAgIHNlc3Npb25fc3RhdGU6IChhY2NvdW50IGFzIGFueSkuc2Vzc2lvbl9zdGF0ZSxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuKchSBPQXV0aCBhY2NvdW50IHVwZGF0ZWQgd2l0aCBuZXcgdG9rZW5zXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBBZ2dpb3JuYSBydW9sbyBlIG5vbWUgc2UgbmVjZXNzYXJpb1xuICAgICAgICAgICAgYXdhaXQgcHJpc21hLnVzZXIudXBkYXRlKHtcbiAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4aXN0aW5nVXNlci5pZCB9LFxuICAgICAgICAgICAgICBkYXRhOiB7IFxuICAgICAgICAgICAgICAgIHJvbGUsXG4gICAgICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lIHx8IGV4aXN0aW5nVXNlci5uYW1lLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEltcG9zdGEgbCdJRCB1dGVudGUgcGVyIE5leHRBdXRoXG4gICAgICAgICAgICB1c2VyLmlkID0gZXhpc3RpbmdVc2VyLmlkO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCLinIUgRXhpc3RpbmcgdXNlciB1cGRhdGVkIGFuZCBhY2NvdW50IGxpbmtlZFwiKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gVXRlbnRlIG5vbiBlc2lzdGUgLSBjcmVhIG1hbnVhbG1lbnRlIHBlcmNow6kgUHJpc21hQWRhcHRlciBmYWxsaXNjZSBzZW56YSBlbWFpbFZlcmlmaWVkXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIuKchSBOZXcgdXNlciAtIGNyZWF0aW5nIG1hbnVhbGx5IChQcmlzbWFBZGFwdGVyIGRvZXNuJ3Qgc3VwcG9ydCBlbWFpbFZlcmlmaWVkIGluIG91ciBzY2hlbWEpXCIpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDcmVhIGwndXRlbnRlIG1hbnVhbG1lbnRlIChzZW56YSBlbWFpbFZlcmlmaWVkIGNoZSBub24gZXNpc3RlIG5lbGxvIHNjaGVtYSlcbiAgICAgICAgICAgIGNvbnN0IG5ld1VzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5jcmVhdGUoe1xuICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgZW1haWw6IHVzZXJFbWFpbCxcbiAgICAgICAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICByb2xlOiByb2xlLFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ3JlYSBsJ2FjY291bnQgT0F1dGggY29sbGVnYXRvXG4gICAgICAgICAgICBhd2FpdCBwcmlzbWEuYWNjb3VudC5jcmVhdGUoe1xuICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkOiBuZXdVc2VyLmlkLFxuICAgICAgICAgICAgICAgIHR5cGU6IGFjY291bnQudHlwZSxcbiAgICAgICAgICAgICAgICBwcm92aWRlcjogYWNjb3VudC5wcm92aWRlcixcbiAgICAgICAgICAgICAgICBwcm92aWRlckFjY291bnRJZDogYWNjb3VudC5wcm92aWRlckFjY291bnRJZCxcbiAgICAgICAgICAgICAgICByZWZyZXNoX3Rva2VuOiBhY2NvdW50LnJlZnJlc2hfdG9rZW4sXG4gICAgICAgICAgICAgICAgYWNjZXNzX3Rva2VuOiBhY2NvdW50LmFjY2Vzc190b2tlbixcbiAgICAgICAgICAgICAgICBleHBpcmVzX2F0OiBhY2NvdW50LmV4cGlyZXNfYXQsXG4gICAgICAgICAgICAgICAgdG9rZW5fdHlwZTogYWNjb3VudC50b2tlbl90eXBlLFxuICAgICAgICAgICAgICAgIHNjb3BlOiBhY2NvdW50LnNjb3BlLFxuICAgICAgICAgICAgICAgIGlkX3Rva2VuOiBhY2NvdW50LmlkX3Rva2VuLFxuICAgICAgICAgICAgICAgIHNlc3Npb25fc3RhdGU6IChhY2NvdW50IGFzIGFueSkuc2Vzc2lvbl9zdGF0ZSxcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEltcG9zdGEgbCdJRCB1dGVudGUgcGVyIE5leHRBdXRoXG4gICAgICAgICAgICB1c2VyLmlkID0gbmV3VXNlci5pZDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi4pyFIE5ldyB1c2VyIGFuZCBPQXV0aCBhY2NvdW50IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwi4p2MIEVycm9yIGR1cmluZyBBenVyZSBBRCBzaWduIGluIGNhbGxiYWNrOlwiLCBlcnJvcik7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRldGFpbHM6XCIsIHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSxcbiAgICAgICAgICAgIHN0YWNrOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3Iuc3RhY2sgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICB1c2VyRW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICBwcm9maWxlRW1haWw6IChwcm9maWxlIGFzIGFueSk/LmVtYWlsLFxuICAgICAgICAgICAgYWNjb3VudDogYWNjb3VudCA/IHsgcHJvdmlkZXI6IGFjY291bnQucHJvdmlkZXIsIHR5cGU6IGFjY291bnQudHlwZSB9IDogbnVsbCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgXG4gICAgYXN5bmMgand0KHsgdG9rZW4sIHVzZXIsIGFjY291bnQsIHRyaWdnZXIgfSkge1xuICAgICAgY29uc29sZS5sb2coXCLwn46rIEpXVCBjYWxsYmFjazpcIiwge1xuICAgICAgICB0cmlnZ2VyLFxuICAgICAgICBoYXNVc2VyOiAhIXVzZXIsXG4gICAgICAgIGhhc0FjY291bnQ6ICEhYWNjb3VudCxcbiAgICAgICAgcHJvdmlkZXI6IGFjY291bnQ/LnByb3ZpZGVyLFxuICAgICAgICB1c2VyRW1haWw6IHRva2VuLmVtYWlsLFxuICAgICAgICB1c2VySWQ6IHVzZXI/LmlkIHx8IHRva2VuLmlkXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgdG9rZW4uaWQgPSB1c2VyLmlkO1xuICAgICAgICB0b2tlbi5yb2xlID0gKHVzZXIgYXMgYW55KS5yb2xlO1xuICAgICAgICBjb25zb2xlLmxvZyhcIuKchSBVc2VyIGRhdGEgYWRkZWQgdG8gdG9rZW46XCIsIHsgaWQ6IHVzZXIuaWQsIHJvbGU6ICh1c2VyIGFzIGFueSkucm9sZSB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gUmVjdXBlcmEgaWwgcnVvbG8gZGFsIGRhdGFiYXNlIHNlIG5vbiBwcmVzZW50ZVxuICAgICAgaWYgKGFjY291bnQgJiYgIXRva2VuLnJvbGUgJiYgdG9rZW4uZW1haWwpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIvCflI0gRmV0Y2hpbmcgdXNlciBmcm9tIERCOlwiLCB0b2tlbi5lbWFpbCk7XG4gICAgICAgICAgY29uc3QgZGJVc2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgICAgICB3aGVyZTogeyBlbWFpbDogdG9rZW4uZW1haWwgfSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoZGJVc2VyKSB7XG4gICAgICAgICAgICB0b2tlbi5pZCA9IGRiVXNlci5pZDtcbiAgICAgICAgICAgIHRva2VuLnJvbGUgPSBkYlVzZXIucm9sZTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi4pyFIFVzZXIgZm91bmQgaW4gREI6XCIsIHsgaWQ6IGRiVXNlci5pZCwgcm9sZTogZGJVc2VyLnJvbGUgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBVc2VyIG5vdCBmb3VuZCBpbiBEQjpcIiwgdG9rZW4uZW1haWwpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwi4p2MIEVycm9yIGZldGNoaW5nIHVzZXIgaW4gand0IGNhbGxiYWNrOlwiLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHRva2VuO1xuICAgIH0sXG4gICAgXG4gICAgYXN5bmMgc2Vzc2lvbih7IHNlc3Npb24sIHRva2VuIH0pIHtcbiAgICAgIGlmIChzZXNzaW9uLnVzZXIpIHtcbiAgICAgICAgKHNlc3Npb24udXNlciBhcyBhbnkpLmlkID0gdG9rZW4uaWQgYXMgc3RyaW5nO1xuICAgICAgICAoc2Vzc2lvbi51c2VyIGFzIGFueSkucm9sZSA9IHRva2VuLnJvbGUgYXMgUm9sZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzZXNzaW9uO1xuICAgIH0sXG4gICAgXG4gICAgYXN5bmMgcmVkaXJlY3QoeyB1cmwsIGJhc2VVcmwgfSkge1xuICAgICAgLy8gYmFzZVVybCDDqCBORVhUQVVUSF9VUkwgKGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMSlcbiAgICAgIC8vIHVybCBwdcOyIGVzc2VyZSBpbCBjYWxsYmFja1VybCBwYXNzYXRvIG8gaWwgZGVmYXVsdCBkaSBOZXh0QXV0aFxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygn8J+UhCBSZWRpcmVjdCBjYWxsYmFjayBjYWxsZWQ6Jywge1xuICAgICAgICB1cmwsXG4gICAgICAgIGJhc2VVcmwsXG4gICAgICAgIGZyb250ZW5kVXJsOiBGUk9OVEVORF9VUkwsXG4gICAgICAgIHVybElzQmFzZVVybDogdXJsID09PSBiYXNlVXJsLFxuICAgICAgICB1cmxJc1Jvb3Q6IHVybCA9PT0gYmFzZVVybCArICcvJyB8fCB1cmwgPT09ICcvJyxcbiAgICAgICAgdXJsVHlwZTogdHlwZW9mIHVybCxcbiAgICAgICAgdXJsTGVuZ3RoOiB1cmw/Lmxlbmd0aFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIFNFTVBSRSByZWluZGlyaXp6YSBhbCBmcm9udGVuZCAtIGFuY2hlIHNlIHVybCBjb250aWVuZSBpbCBjYWxsYmFja1VybCBjb3JyZXR0b1xuICAgICAgLy8gbWEgcG90cmViYmUgZXNzZXJlIHVuIFVSTCBkZWwgYmFja2VuZCBjaGUgdm9nbGlhbW8gY29udmVydGlyZVxuICAgICAgXG4gICAgICAvLyBTZSBsJ1VSTCDDqCBsYSByb290IGRlbCBiYWNrZW5kIG8gaWwgYmFzZVVybCBzdGVzc28gbyB2dW90bywgcmVpbmRpcml6emEgc2VtcHJlIGFsbGEgZGFzaGJvYXJkXG4gICAgICBpZiAoIXVybCB8fCB1cmwgPT09ICcnIHx8IHVybCA9PT0gYmFzZVVybCB8fCB1cmwgPT09IGJhc2VVcmwgKyAnLycgfHwgdXJsID09PSAnLycpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+KchSBVUkwgaXMgYmFja2VuZCByb290IG9yIGVtcHR5LCByZWRpcmVjdGluZyB0byBmcm9udGVuZCBkYXNoYm9hcmQnKTtcbiAgICAgICAgcmV0dXJuIGAke0ZST05URU5EX1VSTH0vYWRtaW4vZGFzaGJvYXJkYDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gU2UgbCdVUkwgw6ggdW4gVVJMIGNvbXBsZXRvIGRlbCBmcm9udGVuZCwgdXNhIHF1ZWxsbyBkaXJldHRhbWVudGVcbiAgICAgIGlmICh1cmwuc3RhcnRzV2l0aChGUk9OVEVORF9VUkwpKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfinIUgVVJMIGlzIGFscmVhZHkgZnJvbnRlbmQgVVJMLCB1c2luZyBpdDonLCB1cmwpO1xuICAgICAgICByZXR1cm4gdXJsO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBTZSBsJ1VSTCBpbml6aWEgY29uIGJhc2VVcmwgKGJhY2tlbmQpLCBzb3N0aXR1aXNjaSBjb24gZnJvbnRlbmRcbiAgICAgIC8vIEVzZW1waW86IGh0dHA6Ly9sb2NhbGhvc3Q6MzAwMS9hZG1pbi9kYXNoYm9hcmQgLT4gaHR0cDovL2xvY2FsaG9zdDozMDAwL2FkbWluL2Rhc2hib2FyZFxuICAgICAgaWYgKHVybC5zdGFydHNXaXRoKGJhc2VVcmwpKSB7XG4gICAgICAgIGNvbnN0IHBhdGggPSB1cmwucmVwbGFjZShiYXNlVXJsLCAnJyk7XG4gICAgICAgIGNvbnN0IHJlZGlyZWN0VXJsID0gYCR7RlJPTlRFTkRfVVJMfSR7cGF0aCB8fCAnL2FkbWluL2Rhc2hib2FyZCd9YDtcbiAgICAgICAgY29uc29sZS5sb2coJ+KchSBDb252ZXJ0aW5nIGJhY2tlbmQgVVJMIHRvIGZyb250ZW5kOicsIHtcbiAgICAgICAgICBvcmlnaW5hbDogdXJsLFxuICAgICAgICAgIHBhdGgsXG4gICAgICAgICAgcmVkaXJlY3RVcmxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZWRpcmVjdFVybDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gU2Ugw6ggdW4gcGVyY29yc28gcmVsYXRpdm8gY2hlIGluaXppYSBjb24gLywgYWdnaXVuZ2kgYWwgZnJvbnRlbmRcbiAgICAgIC8vIEVzZW1waW86IC9hZG1pbi9kYXNoYm9hcmQgLT4gaHR0cDovL2xvY2FsaG9zdDozMDAwL2FkbWluL2Rhc2hib2FyZFxuICAgICAgaWYgKHVybC5zdGFydHNXaXRoKCcvJykpIHtcbiAgICAgICAgLy8gUmltdW92aSBldmVudHVhbGkgcXVlcnkgcGFyYW1zIGRhbCBwZXJjb3JzbyBzZSBwcmVzZW50aVxuICAgICAgICBjb25zdCBwYXRoID0gdXJsLnNwbGl0KCc/JylbMF07XG4gICAgICAgIGNvbnN0IHJlZGlyZWN0VXJsID0gYCR7RlJPTlRFTkRfVVJMfSR7cGF0aH1gO1xuICAgICAgICBjb25zb2xlLmxvZygn4pyFIENvbnZlcnRpbmcgcmVsYXRpdmUgcGF0aCB0byBmcm9udGVuZCBVUkw6Jywge1xuICAgICAgICAgIG9yaWdpbmFsOiB1cmwsXG4gICAgICAgICAgcGF0aCxcbiAgICAgICAgICByZWRpcmVjdFVybFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlZGlyZWN0VXJsO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBTZSBsJ1VSTCDDqCB1biBVUkwgY29tcGxldG8gY2hlIG5vbiBpbml6aWEgY29uIGJhc2VVcmwgbyBGUk9OVEVORF9VUkxcbiAgICAgIC8vIHBvdHJlYmJlIGVzc2VyZSB1biBVUkwgZXN0ZXJubywgbWEgcGVyIHNpY3VyZXp6YSByZWluZGlyaXp6aWFtbyBhbGxhIGRhc2hib2FyZFxuICAgICAgaWYgKHVybC5zdGFydHNXaXRoKCdodHRwOi8vJykgfHwgdXJsLnN0YXJ0c1dpdGgoJ2h0dHBzOi8vJykpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+KaoO+4jyBVUkwgaXMgZXh0ZXJuYWwsIHJlZGlyZWN0aW5nIHRvIGZyb250ZW5kIGRhc2hib2FyZCBmb3Igc2VjdXJpdHk6JywgdXJsKTtcbiAgICAgICAgcmV0dXJuIGAke0ZST05URU5EX1VSTH0vYWRtaW4vZGFzaGJvYXJkYDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gRmFsbGJhY2sgZmluYWxlOiByZWluZGlyaXp6YSBzZW1wcmUgYWxsYSBkYXNoYm9hcmQgZGVsIGZyb250ZW5kXG4gICAgICBjb25zb2xlLmxvZygn4pyFIERlZmF1bHQgZmFsbGJhY2s6IHJlZGlyZWN0aW5nIHRvIGZyb250ZW5kIGRhc2hib2FyZCcpO1xuICAgICAgcmV0dXJuIGAke0ZST05URU5EX1VSTH0vYWRtaW4vZGFzaGJvYXJkYDtcbiAgICB9LFxuICB9LFxuXG4gIHBhZ2VzOiB7XG4gICAgLy8gTk9OIGNvbmZpZ3VyaWFtbyBzaWduSW4gcXVpIC0gTmV4dEF1dGggZGV2ZSByZWluZGlyaXp6YXJlIGRpcmV0dGFtZW50ZSBhZCBBenVyZSBBRFxuICAgIC8vIFNlIGNvbmZpZ3VyaWFtbyBzaWduSW4sIE5leHRBdXRoIHJlaW5kaXJpenphIGFsbGEgcGFnaW5hIGludmVjZSBjaGUgYWwgcHJvdmlkZXJcbiAgICBlcnJvcjogYCR7RlJPTlRFTkRfVVJMfS9hdXRoL2Vycm9yYCxcbiAgfSxcbiAgXG4gIC8vIENhbGxiYWNrIHBlciBnZXN0aXJlIGdsaSBlcnJvcmkgZSByZWluZGlyaXp6YXJlIGNvcnJldHRhbWVudGVcbiAgZXZlbnRzOiB7XG4gICAgYXN5bmMgc2lnbkluKHsgdXNlciwgYWNjb3VudCwgcHJvZmlsZSB9KSB7XG4gICAgICBjb25zb2xlLmxvZyhcIuKchSBTaWduIGluIHN1Y2Nlc3NmdWw6XCIsIHtcbiAgICAgICAgdXNlcjogdXNlci5lbWFpbCxcbiAgICAgICAgcHJvdmlkZXI6IGFjY291bnQ/LnByb3ZpZGVyXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIHNpZ25PdXQoKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIvCfkYsgVXNlciBzaWduZWQgb3V0XCIpO1xuICAgIH0sXG4gIH0sXG5cbiAgc2Vzc2lvbjoge1xuICAgIHN0cmF0ZWd5OiBcImp3dFwiLFxuICAgIG1heEFnZTogMzAgKiAyNCAqIDYwICogNjAsIC8vIDMwIGRheXNcbiAgfSxcblxuICBjb29raWVzOiB7XG4gICAgc2Vzc2lvblRva2VuOiB7XG4gICAgICBuYW1lOiBgJHtwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nID8gJ19fU2VjdXJlLScgOiAnJ31uZXh0LWF1dGguc2Vzc2lvbi10b2tlbmAsXG4gICAgICBvcHRpb25zOiB7XG4gICAgICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgICAgICBzYW1lU2l0ZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICdub25lJyA6ICdsYXgnLFxuICAgICAgICBwYXRoOiAnLycsXG4gICAgICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcbiAgICAgICAgLy8gRG9uJ3Qgc2V0IGRvbWFpbiBpbiBwcm9kdWN0aW9uIGlmIHVzaW5nIHN1YmRvbWFpbiBwYXRoc1xuICAgICAgICAvLyBMZXQgTmV4dEF1dGggaGFuZGxlIGl0IGF1dG9tYXRpY2FsbHlcbiAgICAgIH0sXG4gICAgfSxcbiAgICBjYWxsYmFja1VybDoge1xuICAgICAgbmFtZTogYCR7cHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICdfX1NlY3VyZS0nIDogJyd9bmV4dC1hdXRoLmNhbGxiYWNrLXVybGAsXG4gICAgICBvcHRpb25zOiB7XG4gICAgICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgICAgICBzYW1lU2l0ZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICdub25lJyA6ICdsYXgnLFxuICAgICAgICBwYXRoOiAnLycsXG4gICAgICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBjc3JmVG9rZW46IHtcbiAgICAgIG5hbWU6IGAke3Byb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyAnX19Ib3N0LScgOiAnJ31uZXh0LWF1dGguY3NyZi10b2tlbmAsXG4gICAgICBvcHRpb25zOiB7XG4gICAgICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgICAgICBzYW1lU2l0ZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICdub25lJyA6ICdsYXgnLFxuICAgICAgICBwYXRoOiAnLycsXG4gICAgICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSxcblxuICBzZWNyZXQ6IE5FWFRBVVRIX1NFQ1JFVCxcbiAgZGVidWc6IHRydWUsIC8vIFNlbXByZSBhdHRpdm8gcGVyIGRlYnVnXG4gIGxvZ2dlcjoge1xuICAgIGVycm9yKGNvZGUsIG1ldGFkYXRhKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfwn5S0IE5leHRBdXRoIEVycm9yOicsIHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgbWV0YWRhdGEsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHdhcm4oY29kZSkge1xuICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gTmV4dEF1dGggV2FybmluZzonLCBjb2RlKTtcbiAgICB9LFxuICAgIGRlYnVnKGNvZGUsIG1ldGFkYXRhKSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+QmyBOZXh0QXV0aCBEZWJ1ZzonLCB7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIG1ldGFkYXRhLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfSk7XG4gICAgfSxcbiAgfSxcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRBdXRoU2Vzc2lvbiA9ICgpID0+IHtcbiAgcmV0dXJuIGdldFNlcnZlclNlc3Npb24oYXV0aE9wdGlvbnMpO1xufTtcbiJdLCJuYW1lcyI6WyJBenVyZUFEUHJvdmlkZXIiLCJDcmVkZW50aWFsc1Byb3ZpZGVyIiwiUHJpc21hQWRhcHRlciIsInByaXNtYSIsImJjcnlwdCIsIlJvbGUiLCJnZXRTZXJ2ZXJTZXNzaW9uIiwiQVpVUkVfQURfQ0xJRU5UX0lEIiwiQVpVUkVfQURfQ0xJRU5UX1NFQ1JFVCIsIkFaVVJFX0FEX1RFTkFOVF9JRCIsIk5FWFRBVVRIX1NFQ1JFVCIsInByb2Nlc3MiLCJlbnYiLCJORVhUQVVUSF9VUkwiLCJGUk9OVEVORF9VUkwiLCJBWlVSRV9BRF9SRURJUkVDVF9VUkkiLCJFcnJvciIsImNvbnNvbGUiLCJsb2ciLCJjbGllbnRJZCIsInN1YnN0cmluZyIsImxlbmd0aCIsInRlbmFudElkIiwicmVkaXJlY3RVcmkiLCJuZXh0QXV0aFVybCIsImZyb250ZW5kVXJsIiwic3RhdHVzIiwiZXhwZWN0ZWRSZWRpcmVjdFVyaSIsImF1dGhPcHRpb25zIiwiYWRhcHRlciIsInVybCIsInByb3ZpZGVycyIsImNsaWVudFNlY3JldCIsImF1dGhvcml6YXRpb24iLCJwYXJhbXMiLCJzY29wZSIsInJlc3BvbnNlX3R5cGUiLCJyZXNwb25zZV9tb2RlIiwicHJvbXB0IiwiY2hlY2tzIiwicHJvZmlsZSIsInN1YiIsIm5hbWUiLCJlbWFpbCIsInByZWZlcnJlZF91c2VybmFtZSIsImlkIiwiaW1hZ2UiLCJwaWN0dXJlIiwiY3JlZGVudGlhbHMiLCJsYWJlbCIsInR5cGUiLCJwYXNzd29yZCIsImF1dGhvcml6ZSIsInVzZXIiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJpc1Bhc3N3b3JkVmFsaWQiLCJjb21wYXJlIiwicm9sZSIsImNhbGxiYWNrcyIsInNpZ25JbiIsImFjY291bnQiLCJleGlzdGluZ1VzZXIiLCJpc05ld1VzZXIiLCJwcm92aWRlciIsInVzZXJFbWFpbCIsImhhc0FjY291bnQiLCJoYXNQcm9maWxlIiwicHJvdmlkZXJBY2NvdW50SWQiLCJlcnJvciIsIkFETUlOIiwiVVNFUiIsImV4aXN0aW5nQWNjb3VudCIsImZpbmRGaXJzdCIsInVzZXJJZCIsImNyZWF0ZSIsImRhdGEiLCJyZWZyZXNoX3Rva2VuIiwiYWNjZXNzX3Rva2VuIiwiZXhwaXJlc19hdCIsInRva2VuX3R5cGUiLCJpZF90b2tlbiIsInNlc3Npb25fc3RhdGUiLCJ1cGRhdGUiLCJuZXdVc2VyIiwibWVzc2FnZSIsIlN0cmluZyIsInN0YWNrIiwidW5kZWZpbmVkIiwicHJvZmlsZUVtYWlsIiwiand0IiwidG9rZW4iLCJ0cmlnZ2VyIiwiaGFzVXNlciIsImRiVXNlciIsIndhcm4iLCJzZXNzaW9uIiwicmVkaXJlY3QiLCJiYXNlVXJsIiwidXJsSXNCYXNlVXJsIiwidXJsSXNSb290IiwidXJsVHlwZSIsInVybExlbmd0aCIsInN0YXJ0c1dpdGgiLCJwYXRoIiwicmVwbGFjZSIsInJlZGlyZWN0VXJsIiwib3JpZ2luYWwiLCJzcGxpdCIsInBhZ2VzIiwiZXZlbnRzIiwic2lnbk91dCIsInN0cmF0ZWd5IiwibWF4QWdlIiwiY29va2llcyIsInNlc3Npb25Ub2tlbiIsIm9wdGlvbnMiLCJodHRwT25seSIsInNhbWVTaXRlIiwic2VjdXJlIiwiY2FsbGJhY2tVcmwiLCJjc3JmVG9rZW4iLCJzZWNyZXQiLCJkZWJ1ZyIsImxvZ2dlciIsImNvZGUiLCJtZXRhZGF0YSIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImdldEF1dGhTZXNzaW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db.ts":
/*!***********************!*\
  !*** ./src/lib/db.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\n// Evita di creare piÃ¹ istanze di PrismaClient durante lo sviluppo con hot reloading\nconst globalForPrisma = global;\nconst prisma = globalForPrisma.prisma || new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"query\",\n        \"error\",\n        \"warn\"\n    ] : 0\n});\nif (true) globalForPrisma.prisma = prisma;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (prisma);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2RiLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBOEM7QUFFOUMsb0ZBQW9GO0FBQ3BGLE1BQU1DLGtCQUFrQkM7QUFFakIsTUFBTUMsU0FDWEYsZ0JBQWdCRSxNQUFNLElBQ3RCLElBQUlILHdEQUFZQSxDQUFDO0lBQ2ZJLEtBQUtDLEtBQXlCLEdBQWdCO1FBQUM7UUFBUztRQUFTO0tBQU8sR0FBRyxDQUFTO0FBQ3RGLEdBQUc7QUFFTCxJQUFJQSxJQUF5QixFQUFjSixnQkFBZ0JFLE1BQU0sR0FBR0E7QUFFcEUsaUVBQWVBLE1BQU1BLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcm90b21mb3Jtcy1iYWNrZW5kLy4vc3JjL2xpYi9kYi50cz85ZTRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcclxuXHJcbi8vIEV2aXRhIGRpIGNyZWFyZSBwacO5IGlzdGFuemUgZGkgUHJpc21hQ2xpZW50IGR1cmFudGUgbG8gc3ZpbHVwcG8gY29uIGhvdCByZWxvYWRpbmdcclxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsIGFzIHVua25vd24gYXMgeyBwcmlzbWE6IFByaXNtYUNsaWVudCB9O1xyXG5cclxuZXhwb3J0IGNvbnN0IHByaXNtYSA9XHJcbiAgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSB8fFxyXG4gIG5ldyBQcmlzbWFDbGllbnQoe1xyXG4gICAgbG9nOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyA/IFsncXVlcnknLCAnZXJyb3InLCAnd2FybiddIDogWydlcnJvciddLFxyXG4gIH0pO1xyXG5cclxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPSBwcmlzbWE7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBwcmlzbWE7XHJcblxyXG5cclxuIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsImdsb2JhbEZvclByaXNtYSIsImdsb2JhbCIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\n// Configurazione ottimizzata per performance\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"error\",\n        \"warn\"\n    ] : 0,\n    datasources: {\n        db: {\n            url: process.env.DATABASE_URL\n        }\n    }\n});\n// Connection pooling e ottimizzazioni\nif (true) {\n    globalForPrisma.prisma = prisma;\n}\n// Graceful shutdown\nprocess.on(\"beforeExit\", async ()=>{\n    await prisma.$disconnect();\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBOEM7QUFFOUMsTUFBTUMsa0JBQWtCQztBQUl4Qiw2Q0FBNkM7QUFDdEMsTUFBTUMsU0FBU0YsZ0JBQWdCRSxNQUFNLElBQUksSUFBSUgsd0RBQVlBLENBQUM7SUFDL0RJLEtBQUtDLEtBQXlCLEdBQWdCO1FBQUM7UUFBUztLQUFPLEdBQUcsQ0FBUztJQUMzRUMsYUFBYTtRQUNYQyxJQUFJO1lBQ0ZDLEtBQUtILFFBQVFJLEdBQUcsQ0FBQ0MsWUFBWTtRQUMvQjtJQUNGO0FBQ0YsR0FBRztBQUVILHNDQUFzQztBQUN0QyxJQUFJTCxJQUF5QixFQUFjO0lBQ3pDSixnQkFBZ0JFLE1BQU0sR0FBR0E7QUFDM0I7QUFFQSxvQkFBb0I7QUFDcEJFLFFBQVFNLEVBQUUsQ0FBQyxjQUFjO0lBQ3ZCLE1BQU1SLE9BQU9TLFdBQVc7QUFDMUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcm90b21mb3Jtcy1iYWNrZW5kLy4vc3JjL2xpYi9wcmlzbWEudHM/MDFkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XHJcblxyXG5jb25zdCBnbG9iYWxGb3JQcmlzbWEgPSBnbG9iYWxUaGlzIGFzIHVua25vd24gYXMge1xyXG4gIHByaXNtYTogUHJpc21hQ2xpZW50IHwgdW5kZWZpbmVkO1xyXG59O1xyXG5cclxuLy8gQ29uZmlndXJhemlvbmUgb3R0aW1penphdGEgcGVyIHBlcmZvcm1hbmNlXHJcbmV4cG9ydCBjb25zdCBwcmlzbWEgPSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID8/IG5ldyBQcmlzbWFDbGllbnQoe1xyXG4gIGxvZzogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBbJ2Vycm9yJywgJ3dhcm4nXSA6IFsnZXJyb3InXSxcclxuICBkYXRhc291cmNlczoge1xyXG4gICAgZGI6IHtcclxuICAgICAgdXJsOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwsXHJcbiAgICB9LFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLy8gQ29ubmVjdGlvbiBwb29saW5nIGUgb3R0aW1penphemlvbmlcclxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcclxuICBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hO1xyXG59XHJcblxyXG4vLyBHcmFjZWZ1bCBzaHV0ZG93blxyXG5wcm9jZXNzLm9uKCdiZWZvcmVFeGl0JywgYXN5bmMgKCkgPT4ge1xyXG4gIGF3YWl0IHByaXNtYS4kZGlzY29ubmVjdCgpO1xyXG59KTtcclxuXHJcblxyXG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiLCJkYXRhc291cmNlcyIsImRiIiwidXJsIiwiZW52IiwiREFUQUJBU0VfVVJMIiwib24iLCIkZGlzY29ubmVjdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/bcryptjs","vendor-chunks/jose","vendor-chunks/next-auth","vendor-chunks/openid-client","vendor-chunks/oauth","vendor-chunks/@babel","vendor-chunks/object-hash","vendor-chunks/preact","vendor-chunks/yallist","vendor-chunks/preact-render-to-string","vendor-chunks/lru-cache","vendor-chunks/cookie","vendor-chunks/@auth","vendor-chunks/@panva","vendor-chunks/oidc-token-hash"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fforms%2Fpublic%2Froute&page=%2Fapi%2Fforms%2Fpublic%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fforms%2Fpublic%2Froute.ts&appDir=C%3A%5CUsers%5CGiuseppe%20Mursia%5CDocuments%5CGitHub%5CAGO_Explorer%5CProtomForms%5Cprotomforms-backend%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CGiuseppe%20Mursia%5CDocuments%5CGitHub%5CAGO_Explorer%5CProtomForms%5Cprotomforms-backend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();